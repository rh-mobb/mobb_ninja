<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.109.0"><meta name=generator content="Relearn 5.2.3+tip"><meta name=description content><title>Dynamic Certificates for ROSA Custom Domain :: Managed OpenShift Black Belt - Unofficial Documentation</title><link href=https://rh-mobb.github.io/mobb_ninja/css/fontawesome-all.min.css?1673630121 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/fontawesome-all.min.css?1673630121 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/featherlight.min.css?1673630121 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/featherlight.min.css?1673630121 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/auto-complete.css?1673630121 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/auto-complete.css?1673630121 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/perfect-scrollbar.min.css?1673630121 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/nucleus.css?1673630121 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/fonts.css?1673630121 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/fonts.css?1673630121 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/theme.css?1673630121 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/theme-red.css?1673630121 rel=stylesheet id=variant-style><link href=https://rh-mobb.github.io/mobb_ninja/css/ie.css?1673630121 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/variant.css?1673630121 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/print.css?1673630121 rel=stylesheet media=print><script src=https://rh-mobb.github.io/mobb_ninja/js/variant.js?1673630121></script>
<script>var index_url="https://rh-mobb.github.io/mobb_ninja/index.json",baseUriFull,root_url="https://rh-mobb.github.io/mobb_ninja/",baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",baseUriFull="https://rh-mobb.github.io/mobb_ninja/",window.variants&&variants.init(["red"])</script><script src=https://rh-mobb.github.io/mobb_ninja/js/jquery.min.js?1673630121 defer></script></head><body class="mobile-support default" data-url=https://rh-mobb.github.io/mobb_ninja/docs/rosa/dynamic-certificates/><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next" href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/static-ip-load-balancer/ title="Configure a load balancer service to use a static public IP (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev" href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/clf-cloudwatch-vector/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title='Menu (CTRL+ALT+m)'><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title='Table of Contents (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="4"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/><span itemprop=name>Red Hat Openshift Service on AWS</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/dynamic-certificates/ aria-disabled=true><span itemprop=name>Dynamic Certificates for ROSA Custom Domain</span></a></li></ol></div><div class="default-animation progress"><div class=wrapper><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#set-up-environment>Set up environment</a></li><li><a href=#prepare-aws-account>Prepare AWS Account</a></li><li><a href=#set-up-cert-manager>Set up cert-manager</a></li><li><a href=#create-the-issuer-and-the-certficiate>Create the Issuer and the Certficiate</a><ul><li><a href=#configure-certificate-requestor>Configure Certificate Requestor</a></li><li><a href=#create-the-certificate-which-will-later-be-used-by-the-custom-domain>Create the Certificate, which will later be used by the Custom Domain.</a></li></ul></li><li><a href=#create-the-custom-domain-which-will-be-used-to-access-your-applications>Create the Custom Domain, which will be used to access your applications.</a></li><li><a href=#dynamic-certificates-for-custom-domain-routes>Dynamic Certificates for Custom Domain Routes.</a></li><li><a href=#test-an-application>Test an application.</a></li><li><a href=#debugging>Debugging</a></li></ul></nav></div></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags><div class=tags><a class=tag-link href=https://rh-mobb.github.io/mobb_ninja/tags/aws>AWS</a>
<a class=tag-link href=https://rh-mobb.github.io/mobb_ninja/tags/rosa>ROSA</a></div></div><style>.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert-warning{background-color:#fcf8e3;border-color:#fbeed5;color:#c09853}</style><p class="alert alert-warning"><b>IMPORTANT NOTE</b>: This site is not official Red Hat documentation and is provided for informational purposes only. These guides may be experimental, proof of concept, or early adoption. Officially supported documentation is available at <a href=https://docs.openshift.com target=_blank>docs.openshift.com</a> and <a href=https://access.redhat.com target=_blank>access.redhat.com</a>.</p><article class=default><h1>Dynamic Certificates for ROSA Custom Domain</h1><p><em>last edited 11 Oct 2022</em></p><p>There may be situations when you prefer not to use wild-card certificates. This ROSA guide talks about certificate management with cert-manager and letsencrypt, to dynamically issue certificates to routes created on a custom domain that&rsquo;s hosted on AWS Route53.</p><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#set-up-environment>Set up environment</a></li><li><a href=#prepare-aws-account>Prepare AWS Account</a></li><li><a href=#set-up-cert-manager>Set up cert-manager</a></li><li><a href=#create-the-issuer-and-the-certficiate>Create the Issuer and the Certficiate</a><ul><li><a href=#configure-certificate-requestor>Configure Certificate Requestor</a></li><li><a href=#create-the-certificate-which-will-later-be-used-by-the-custom-domain>Create the Certificate, which will later be used by the Custom Domain.</a></li></ul></li><li><a href=#create-the-custom-domain-which-will-be-used-to-access-your-applications>Create the Custom Domain, which will be used to access your applications.</a></li><li><a href=#dynamic-certificates-for-custom-domain-routes>Dynamic Certificates for Custom Domain Routes.</a></li><li><a href=#test-an-application>Test an application.</a></li><li><a href=#debugging>Debugging</a></li></ul><h2 id=prerequisites>Prerequisites</h2><ul><li>A Red Hat OpenShift on AWS (ROSA) cluster</li><li>The oc CLI #logged in.</li><li>The aws CLI #logged in.</li><li>The rosa CLI #logged in.</li><li>jq</li><li>gettext</li><li>A Public Route53 Hosted Zone, and the related Domain to use.</li></ul><h2 id=set-up-environment>Set up environment</h2><ol><li><p>Export few environment variables</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export CLUSTER_NAME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;sts-pvtlnk-cluster&#34;</span>
</span></span><span style=display:flex><span>export OIDC_PROVIDER<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>oc get authentication.config.openshift.io cluster -o json <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>| jq -r .spec.serviceAccountIssuer| sed -e <span style=color:#e6db74>&#34;s/^https:\/\///&#34;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>export AWS_ACCOUNT_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>aws sts get-caller-identity --query Account --output text<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>export SCRATCH_DIR<span style=color:#f92672>=</span>/tmp/scratch
</span></span><span style=display:flex><span>export AWS_PAGER<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>export LETSENCRYPT_EMAIL<span style=color:#f92672>=</span>youremail@work.com
</span></span><span style=display:flex><span>export HOSTED_ZONE_ID<span style=color:#f92672>=</span>ABCDEFGHEXAMPLE
</span></span><span style=display:flex><span>export HOSTED_ZONE_REGION<span style=color:#f92672>=</span>us-east-2
</span></span><span style=display:flex><span>export DOMAIN<span style=color:#f92672>=</span>lab.domain.com   <span style=color:#75715e>#Custom Hosted Zone Domain for apps</span>
</span></span><span style=display:flex><span>mkdir -p $SCRATCH_DIR
</span></span></code></pre></div></li><li><p>Install jq & gettext</p><p>Installing or ensuring the gettext & jq package is installed, will allow us to use envsubst to simplify some of our configuration so we can use output of CLI commands as input into YAMLs to reduce the complexity of manual editing.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>brew install gettext jq
</span></span><span style=display:flex><span><span style=color:#75715e># or, for Linux / Windows WSL</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#sudo dnf install gettext jq</span>
</span></span></code></pre></div></li></ol><h2 id=prepare-aws-account>Prepare AWS Account</h2><p>In order to make changes to the AWS Route53 Hosted Zone to add/remove DNS TXT challenge records by the cert-manager pod, we first need to create an IAM role with specific policy permissions & a trust relationship to allow access to the pod.</p><blockquote><p>My Custom Domain Hosted Zone is in the same accout as the ROSA cluster. If these are in different accounts, few additional steps for <a href=https://cert-manager.io/docs/configuration/acme/dns01/route53/#cross-account-access>Cross Account Access</a> will be required.</p></blockquote><ol><li><p>Prepare an IAM Policy file</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>&lt;&lt;EOF</span> <span style=color:#960050;background-color:#1e0010>&gt;</span> <span style=color:#960050;background-color:#1e0010>$SCRATCH_DIR/cert-manager-r</span><span style=color:#ae81ff>53</span><span style=color:#960050;background-color:#1e0010>-policy.json</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#e6db74>&#34;2012-10-17&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Statement&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;route53:GetChange&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:route53:::change/*&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route53:ChangeResourceRecordSets&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;route53:ListResourceRecordSets&#34;</span>
</span></span><span style=display:flex><span>      ],
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:route53:::hostedzone/*&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;route53:ListHostedZonesByName&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Resource&#34;</span>: <span style=color:#e6db74>&#34;*&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>EOF</span>
</span></span></code></pre></div></li><li><p>Create the IAM Policy using the above created file.</p><blockquote><p>This creates a named policy for the cluster, you could use a generic policy for multiple clusters to keep things simpler.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>POLICY<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>aws iam create-policy --policy-name <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CLUSTER_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>-cert-manager-r53-policy&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   --policy-document file://$SCRATCH_DIR/cert-manager-r53-policy.json <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   --query <span style=color:#e6db74>&#39;Policy.Arn&#39;</span> --output text<span style=color:#66d9ef>)</span> <span style=color:#f92672>||</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>echo $POLICY
</span></span></code></pre></div></li><li><p>Create a Trust Policy</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>&lt;&lt;EOF</span> <span style=color:#960050;background-color:#1e0010>&gt;</span> <span style=color:#960050;background-color:#1e0010>$SCRATCH_DIR/TrustPolicy.json</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Version&#34;</span>: <span style=color:#e6db74>&#34;2012-10-17&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;Statement&#34;</span>: [
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Effect&#34;</span>: <span style=color:#e6db74>&#34;Allow&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Principal&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;Federated&#34;</span>: <span style=color:#e6db74>&#34;arn:aws:iam::${AWS_ACCOUNT_ID}:oidc-provider/${OIDC_PROVIDER}&#34;</span>
</span></span><span style=display:flex><span>      },
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Action&#34;</span>: <span style=color:#e6db74>&#34;sts:AssumeRoleWithWebIdentity&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:#f92672>&#34;Condition&#34;</span>: {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;StringEquals&#34;</span>: {
</span></span><span style=display:flex><span>          <span style=color:#f92672>&#34;${OIDC_PROVIDER}:sub&#34;</span>: [
</span></span><span style=display:flex><span>            <span style=color:#e6db74>&#34;system:serviceaccount:cert-manager:cert-manager&#34;</span>
</span></span><span style=display:flex><span>          ]
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>EOF</span>
</span></span></code></pre></div></li><li><p>Create an IAM Role for the cert-manager Operator, with the above trust policy.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>ROLE<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>aws iam create-role <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --role-name <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CLUSTER_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>-cert-manager-operator&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --assume-role-policy-document file://$SCRATCH_DIR/TrustPolicy.json <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --query <span style=color:#e6db74>&#34;Role.Arn&#34;</span> --output text<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>echo $ROLE
</span></span></code></pre></div></li><li><p>Attach the permissions policy to the Role</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>aws iam attach-role-policy <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   --role-name <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>CLUSTER_NAME<span style=color:#e6db74>}</span><span style=color:#e6db74>-cert-manager-operator&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>   --policy-arn $POLICY
</span></span></code></pre></div></li></ol><h2 id=set-up-cert-manager>Set up cert-manager</h2><ol><li><p>Create a project (namespace) in the ROSA cluster.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc new-project cert-manager --display-name<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Certificate Manager&#34;</span> --description<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Project  contains Certificates and Custom Domain related components.&#34;</span>
</span></span></code></pre></div></li><li><p>Install the cert-manager Operator</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>cat &lt;&lt;EOF | oc create -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>operators.coreos.com/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>OperatorGroup</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>generateName</span>: <span style=color:#ae81ff>cert-manager-</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>operators.coreos.com/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Subscription</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>channel</span>: <span style=color:#ae81ff>stable</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>installPlanApproval</span>: <span style=color:#ae81ff>Automatic</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>source</span>: <span style=color:#ae81ff>community-operators</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>sourceNamespace</span>: <span style=color:#ae81ff>openshift-marketplace</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div><blockquote><p><em>It will take a few minutes for this operator to install and complete its set up.</em></p></blockquote></li><li><p>Wait for cert-manager operator to finish installing.</p><p>Our next steps depends on the successful installation of the operator. I recommend that you login to your cluster console to confirm the succeess status of cert-manager operator, in the Installed Operators section.</p><p><img src=operator_install_status.png alt="View cert-manager Operator"></p></li><li><p>Annotate the ServiceAccount.</p><p>This is to enable the AWS SDK client code running within the cert-manager pod to interact with AWS STS service for temporary tokens, by assuming the IAM Role that was created in an earlier step. This is referred to as <a href=https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html>IRSA</a>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc annotate serviceaccount cert-manager -n cert-manager eks.amazonaws.com/role-arn<span style=color:#f92672>=</span>$ROLE
</span></span></code></pre></div><blockquote><p><em>Normally, after ServiceAccount annotations, a restart of the pod is required. However, the next step will automatically cause a restart of the pod.</em></p></blockquote></li><li><p>Update the CA truststore of the cert-manager pod.</p><p>This step is usually not required. However, it was noticed that the cert-manager pod had difficulties in trusting the <a href=sts.amazonaws.com>STS</a> & <a href=acme-v02.api.letsencrypt.org>LetsEncrypt</a> endpoints. So the below commands essentially downloads the CA chain of these endpoints, puts them into a ConfigMap, which then gets attached to the pod as a Volume.
Along with this step, I&rsquo;ll also be <a href=https://cert-manager.io/docs/configuration/acme/dns01/#setting-nameservers-for-dns01-self-check>setting the NameServers that the cert-manager will use for DNS01 self-check</a>
The Volume attachment to the pod and the setting of NameServers will be done together by patching the cert-manager CSV resource to persist these changes to the cert-manager deployment. This will cause the rollout of a new deployment and restart of the cert-manager pod.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>openssl s_client -showcerts -verify <span style=color:#ae81ff>5</span> -connect sts.amazonaws.com:443 &lt; /dev/null 2&gt; /dev/null | awk <span style=color:#e6db74>&#39;/BEGIN/,/END/{ if(/BEGIN/){a++}; print}&#39;</span>  &gt; $SCRATCH_DIR/extra-ca.pem
</span></span><span style=display:flex><span>openssl s_client -showcerts -verify <span style=color:#ae81ff>5</span> -connect acme-v02.api.letsencrypt.org:443 &lt; /dev/null 2&gt; /dev/null | awk <span style=color:#e6db74>&#39;/BEGIN/,/END/{ if(/BEGIN/){a++}; print}&#39;</span>  &gt;&gt; $SCRATCH_DIR/extra-ca.pem
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc create configmap extra-ca --from-file<span style=color:#f92672>=</span>$SCRATCH_DIR/extra-ca.pem -n cert-manager
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>CERT_MANAGER_CSV_NAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>oc get csv | grep <span style=color:#e6db74>&#39;cert-manager&#39;</span> | awk <span style=color:#e6db74>&#39;{print $1}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>CLUSTER_DNS_SERVICE_IP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>oc get svc -n openshift-dns | grep <span style=color:#e6db74>&#39;dns-default&#39;</span> | awk <span style=color:#e6db74>&#39;{print $3}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>echo $CERT_MANAGER_CSV_NAME
</span></span><span style=display:flex><span>echo $CLUSTER_DNS_SERVICE_IP
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc patch csv $CERT_MANAGER_CSV_NAME --type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;json&#39;</span> -p <span style=color:#e6db74>&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/spec/install/spec/deployments/0/spec/template/spec/containers/0/args/-&#34;, &#34;value&#34;:&#39;</span>--dns01-recursive-nameservers-only<span style=color:#e6db74>&#39;}, {&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/spec/install/spec/deployments/0/spec/template/spec/containers/0/args/-&#34;, &#34;value&#34;:&#39;</span>--dns01-recursive-nameservers<span style=color:#f92672>=</span>$CLUSTER_DNS_SERVICE_IP:53<span style=color:#e6db74>&#39;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc patch csv $CERT_MANAGER_CSV_NAME --type<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;json&#39;</span> -p <span style=color:#e6db74>&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/spec/install/spec/deployments/0/spec/template/spec/volumes&#34;, &#34;value&#34;: [{&#34;name&#34;: &#34;extra-ca&#34;}]}, {&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/spec/install/spec/deployments/0/spec/template/spec/volumes/0/configMap&#34;, &#34;value&#34;: {&#34;name&#34;: &#34;extra-ca&#34;, &#34;defaultMode&#34;: 420}}, {&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/spec/install/spec/deployments/0/spec/template/spec/containers/0/volumeMounts&#34;, &#34;value&#34;: [{&#34;name&#34;: &#34;extra-ca&#34;, &#34;mountPath&#34;: &#34;/etc/ssl/certs/extra-ca-bundle.pem&#34;, &#34;readOnly&#34;: true, &#34;subPath&#34;: &#34;extra-ca-bundle.pem&#34;}]}]&#39;</span>
</span></span></code></pre></div><blockquote><p><em>During an Operator upgrade, the above changes might be lost. There seems to be improvement plans to facilitate these changes directly through the Operator config, but until then, it&rsquo;d be a good idea to maintain some automation around this to persist these changes if it ever gets overridden to defaults.</em></p></blockquote></li></ol><h2 id=create-the-issuer-and-the-certficiate>Create the Issuer and the Certficiate</h2><h3 id=configure-certificate-requestor>Configure Certificate Requestor</h3><ol start=3><li><p>Create Cluster Issuer to use Let&rsquo;s Encrypt</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>envsubst  &lt;&lt;EOF | oc apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencryptissuer</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>acme</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>server</span>: <span style=color:#ae81ff>https://acme-v02.api.letsencrypt.org/directory</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>email</span>: <span style=color:#ae81ff>$LETSENCRYPT_EMAIL</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># This key doesn&#39;t exist, cert-manager creates it</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>privateKeySecretRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>prod-letsencrypt-issuer-account-key</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>solvers</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>dns01</span>:
</span></span><span style=display:flex><span>        <span style=color:#f92672>route53</span>:
</span></span><span style=display:flex><span>         <span style=color:#f92672>hostedZoneID</span>: <span style=color:#ae81ff>$HOSTED_ZONE_ID</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>region</span>: <span style=color:#ae81ff>$HOSTED_ZONE_REGION</span>
</span></span><span style=display:flex><span>         <span style=color:#f92672>secretAccessKeySecretRef</span>:
</span></span><span style=display:flex><span>           <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div></li><li><p>Describe the ClusterIssuer to confirm it&rsquo;s ready.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc describe clusterissuer letsencryptissuer
</span></span></code></pre></div><p>You should see an output that mentions that the issuer is Registered/Ready</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>Conditions:
</span></span><span style=display:flex><span> Last Transition Time:  2022-11-17T10:29:37Z
</span></span><span style=display:flex><span> Message:               The ACME account was registered with the ACME server
</span></span><span style=display:flex><span> Observed Generation:   1
</span></span><span style=display:flex><span> Reason:                ACMEAccountRegistered
</span></span><span style=display:flex><span> Status:                True
</span></span><span style=display:flex><span> Type:                  Ready
</span></span><span style=display:flex><span>Events:                 &lt;none&gt;
</span></span></code></pre></div><p>Once the above command is complete, the status of the ClusterIssues in the cluster console will look similar to the below screenshot.</p><p><img src=cluster_issuer_status.png alt="cluster issuer"></p></li></ol><h3 id=create-the-certificate-which-will-later-be-used-by-the-custom-domain>Create the Certificate, which will later be used by the Custom Domain.</h3><blockquote><p><em>I&rsquo;ve used a SAN certificate here to show how SAN certificates could be created, which will be useful for clusters intended to run only a fixed set of applications. However, this is optional; a single subject/domain certificate works too</em></p></blockquote><ol><li><p>Configure the Certificate</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>envsubst  &lt;&lt;EOF | oc apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>cert-manager.io/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Certificate</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>customdomain-cert</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>secretName</span>: <span style=color:#ae81ff>custom-domain-certificate-tls</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>issuerRef</span>:
</span></span><span style=display:flex><span>     <span style=color:#f92672>name</span>: <span style=color:#ae81ff>letsencryptissuer</span>
</span></span><span style=display:flex><span>     <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>ClusterIssuer</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>commonName</span>: <span style=color:#e6db74>&#34;x.apps.$DOMAIN&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>dnsNames</span>:
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;x.apps.$DOMAIN&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;y.apps.$DOMAIN&#34;</span>
</span></span><span style=display:flex><span>  - <span style=color:#e6db74>&#34;z.apps.$DOMAIN&#34;</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div></li><li><p>View the Certificate status</p><p>It&rsquo;ll take upto 5 minutes for the Certificate to show as Ready status. If it takes too long, the oc describe command will mention issues if any.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc get certificate customdomain-cert -n cert-manager
</span></span><span style=display:flex><span>oc describe certificate customdomain-cert -n cert-manager
</span></span></code></pre></div></li></ol><h2 id=create-the-custom-domain-which-will-be-used-to-access-your-applications>Create the Custom Domain, which will be used to access your applications.</h2><ol><li><p>Create the Custom Domain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>envsubst  &lt;&lt;EOF | oc apply -f -</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>managed.openshift.io/v1alpha1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>CustomDomain</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>appdomain</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>domain</span>: <span style=color:#ae81ff>x.apps.$DOMAIN</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>certificate</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#ae81ff>custom-domain-certificate-tls</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>cert-manager</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>scope</span>: <span style=color:#ae81ff>Internal</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>EOF</span>
</span></span></code></pre></div></li><li><p>View the status of the Custom Domain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc get customdomain appdomain -n cert-manager
</span></span></code></pre></div><blockquote><p><em>It will take 2-3 minutes for the custom domain to change from NotReady to Ready status. When ready, an endpoint also will be visible in the output of the above command, as shown below</em></p></blockquote></li></ol><p><img src=custom_domains.png alt="Custom Domains"></p><ol><li>Next, we need to add a DNS record in my Custom Domain Route53 Hosted Zone to CNAME the the wildcard applications domain to the above obtained endpoint, as shown below.</li></ol><p><img src=route53_cname.png alt="CNAME the custom domain to the endpoint"></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>CUSTOM_DOMAIN_ENDPOINT<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>oc get customdomain appdomain -n cert-manager | grep <span style=color:#e6db74>&#39;appdomain&#39;</span> | awk <span style=color:#e6db74>&#39;{print $2}&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>echo $CUSTOM_DOMAIN_ENDPOINT
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>cat</span> <span style=color:#960050;background-color:#1e0010>&lt;&lt;EOF</span> <span style=color:#960050;background-color:#1e0010>&gt;</span> <span style=color:#960050;background-color:#1e0010>$SCRATCH_DIR/add_cname_record.json</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Comment&#34;</span>:<span style=color:#e6db74>&#34;Add apps CNAME to Custom Domain Endpoint&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Changes&#34;</span>:[{
</span></span><span style=display:flex><span>       <span style=color:#f92672>&#34;Action&#34;</span>:<span style=color:#e6db74>&#34;CREATE&#34;</span>,
</span></span><span style=display:flex><span>       <span style=color:#f92672>&#34;ResourceRecordSet&#34;</span>:{
</span></span><span style=display:flex><span> 	       <span style=color:#f92672>&#34;Name&#34;</span>: <span style=color:#e6db74>&#34;*.apps.$DOMAIN&#34;</span>,
</span></span><span style=display:flex><span> 		   <span style=color:#f92672>&#34;Type&#34;</span>:<span style=color:#e6db74>&#34;CNAME&#34;</span>,
</span></span><span style=display:flex><span> 		   <span style=color:#f92672>&#34;TTL&#34;</span>:<span style=color:#ae81ff>30</span>,
</span></span><span style=display:flex><span> 		   <span style=color:#f92672>&#34;ResourceRecords&#34;</span>:[{
</span></span><span style=display:flex><span> 			   <span style=color:#f92672>&#34;Value&#34;</span>: <span style=color:#e6db74>&#34;$CUSTOM_DOMAIN_ENDPOINT&#34;</span>
</span></span><span style=display:flex><span> 		   }]
</span></span><span style=display:flex><span> 	   }
</span></span><span style=display:flex><span>    }]
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>EOF</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>aws route53 change-resource-record-sets --hosted-zone-id $HOSTED_ZONE_ID --change-batch file://$SCRATCH_DIR/add_cname_record.json
</span></span></code></pre></div><blockquote><p><em>The wild card CNAME&rsquo;ing avoids the need to create a new record for every new application. The certificate that each of these applications use will NOT be a wildcard certificate</em></p></blockquote><p>At this stage, you will be able to expose cluster applications on any of the listed DNS names that were specified in the previously created Certificate. But what if you have many more applications that will need to be securely exposed too. Well, one approach is to keep updating the Certificate resource with additional SAN names as more applications prepare to get onboarded, and this Certificate update which will trigger an update to the Custom Domain to honor the newly added SAN names. Another approach is to dynamically issue a Certificate to every new Route; Read on to find the details about this latter approach.</p><h2 id=dynamic-certificates-for-custom-domain-routes>Dynamic Certificates for Custom Domain Routes.</h2><ol><li>Create OpenShift resources required for issuing Dynamic Certificates to Routes.</li></ol><p>This step will create a new deployment (and hence a pod) that&rsquo;ll watch out for specifically annotated routes in the cluster, and if the issuer-kind and issuer-name annotations are found in a new route, it&rsquo;ll request the Issuer (ClusterIssuer in my case) for a new Certificate that&rsquo;s unique to this route and which&rsquo;ll honor the hostname that was specified while creating the route.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc apply -f https://github.com/cert-manager/openshift-routes/releases/latest/download/cert-manager-openshift-routes.yaml -n cert-manager
</span></span></code></pre></div><blockquote><p><em>Additonal OpenShift resources such as a ClusterRole (with permissions to watch and update the routes across the cluster), a ServiceAccount (with these permissions, that will be used to run this newly created pod) and a ClusterRoleBinding to bind these two resources, will be created in this step too.</em>
<em>If the cluster does not have access to github, you may as well save the raw contents locally, and run oc apply -f localfilename.yaml -n cert-manager</em></p></blockquote><ol start=2><li>View the status of the new pod.</li></ol><p>Check if all the pods are running successfully and that the events do not mention any errors.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc get po -n cert-manager
</span></span></code></pre></div><h2 id=test-an-application>Test an application.</h2><ol><li><p>Create a test applciation in a new namespace.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc new-project testapp
</span></span><span style=display:flex><span>oc new-app --docker-image<span style=color:#f92672>=</span>docker.io/openshift/hello-openshift -n testapp
</span></span></code></pre></div></li><li><p>Expose the test application Service.</p><p>Let&rsquo;s create a Route to expose the application from outside the cluster, and annotate the Route to give it a new Certificate.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc create route edge --service<span style=color:#f92672>=</span>hello-openshift testroute --hostname hello.apps.$DOMAIN -n testapp
</span></span><span style=display:flex><span>oc annotate route testroute -n testapp cert-manager.io/issuer-kind<span style=color:#f92672>=</span>ClusterIssuer cert-manager.io/issuer-name<span style=color:#f92672>=</span>letsencryptissuer
</span></span></code></pre></div><blockquote><p><em>It will take a 2-3 minutes for the Certificate to be created. The renewal of the certitificate will automatically be managed by the cert-manager compoenents as it approaches expiry.</em></p></blockquote></li><li><p>Access the application Route.</p><p>Do a curl test (or any http client of your preference) to confirm there are no certificate related errors.</p><blockquote><p><em>Output should print &ldquo;Hello OpenShfit!&rdquo;, and you should also notice a line that says &ldquo;subjectAltName: host hello.apps.$DOMIAN&rdquo; matched cert&rsquo;s &ldquo;hello.apps.$DOMIAN&rdquo;</em></p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>curl -vv https://hello.apps.$DOMAIN
</span></span></code></pre></div></li></ol><h2 id=debugging>Debugging</h2><p>Please note that while creating certificates, the validation process usually take upto 2-3 minutes to complete.</p><p>If you face issues during certificate create step, run &lsquo;oc describe&rsquo; against each of - &lsquo;certificate,certificaterequest,order & challenge&rsquo; resources to view the events/reasons that&rsquo;ll mostly help with identifying the cause of the issue.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc get certificate,certificaterequest,order,challenge
</span></span></code></pre></div><p>This is a very <a href=https://cert-manager.io/docs/faq/acme/>helpful guide in debugging certificates</a> as well.</p><p>You may also use the <a href=https://cert-manager.io/docs/reference/cmctl/>cmctl</a> CLI tool for various certificate management activities such as to check the status of certificates, testing renewals etc.</p><footer class=footline></footer></article></div></main></div><aside id=sidebar class=default-animation><div id=header-wrapper class=default-animation><div id=header class=default-animation><style>#logo svg,#logo svg *{color:#282828;color:var(--MENU-SECTIONS-BG-color);fill:#282828!important;fill:var(--MENU-SECTIONS-BG-color)!important;opacity:.945}a#logo{color:#282828;color:var(--MENU-SECTIONS-BG-color);font-family:work sans,helvetica,tahoma,geneva,arial,sans-serif;font-size:30px;font-weight:300;margin-top:-13px;max-width:80%;text-transform:uppercase;width:226px;white-space:nowrap}a#logo:hover{color:#282828;color:var(--MENU-SECTIONS-BG-color)}#logo svg{margin-bottom:-20px;margin-left:-23.5px;width:40.5%}@media only all and (max-width:59.938em){a#logo{font-size:25px;margin-top:-3px}#logo svg{margin-bottom:-12px;margin-left:-23px}}@media all and (-ms-high-contrast:none){a#logo{margin-top:-58px}#logo svg{margin-bottom:-62px}}</style><a id=logo href=https://rh-mobb.github.io/mobb_ninja/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M341.52 285.56c33.65.0 82.34-6.94 82.34-47 .22-6.74.86-1.82-20.88-96.24-4.62-19.15-8.68-27.84-42.31-44.65-26.09-13.34-82.92-35.37-99.73-35.37-15.66.0-20.2 20.17-38.87 20.17-18 0-31.31-15.06-48.12-15.06-16.14.0-26.66 11-34.78 33.62-27.5 77.55-26.28 74.27-26.12 78.27.0 24.8 97.64 106.11 228.47 106.11M429 254.84c4.65 22 4.65 24.35 4.65 27.25.0 37.66-42.33 58.56-98 58.56-125.74.08-235.91-73.65-235.91-122.33a49.55 49.55.0 014.06-19.72C58.56 200.86.0 208.93.0 260.63c0 84.67 200.63 189 359.49 189 121.79.0 152.51-55.08 152.51-98.58.0-34.21-29.59-73.05-82.93-96.24"/></svg>MOBB Ninja</a></div><div class="searchbox default-animation"><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script>var contentLangs=["en"]</script><script src=https://rh-mobb.github.io/mobb_ninja/js/auto-complete.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.stemmer.support.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.multi.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.en.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/search.js?1673630121 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=https://rh-mobb.github.io/mobb_ninja/><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics collapsible-menu"><li data-nav-id=/docs/ title="Documentation from the MOBB" class="dd-item parent"><input type=checkbox id=section-2f67fdc9a362fd86f1cfd4450ed56551 class=toggle checked><label for=section-2f67fdc9a362fd86f1cfd4450ed56551></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/>Documentation from the MOBB</a><ul><li data-nav-id=/docs/quickstart-aro/ title="ARO Quickstart" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/quickstart-aro/>ARO Quickstart</a></li><li data-nav-id=/docs/quickstart-rosa/ title="ROSA Quickstart" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/quickstart-rosa/>ROSA Quickstart</a></li><li data-nav-id=/docs/aro/ title="Azure Red Hat OpenShift" class=dd-item><input type=checkbox id=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a class=toggle><label for=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/>Azure Red Hat OpenShift</a><ul><li data-nav-id=/docs/aro/shipping-logs-and-metrics-to-azure-blob/ title="Azure Red Hat Openshift - Shippings logs and metrics to Azure Blob storage" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/shipping-logs-and-metrics-to-azure-blob/>Azure Red Hat Openshift - Shippings logs and metrics to Azure Blob storage</a></li><li data-nav-id=/docs/aro/registry/ title="Accessing the Internal Registry from ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/registry/>Accessing the Internal Registry from ARO</a></li><li data-nav-id=/docs/aro/additional-ingress-controller/ title="Adding an additional ingress controller to an ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/additional-ingress-controller/>Adding an additional ingress controller to an ARO cluster</a></li><li data-nav-id=/docs/aro/add-infra-nodes/ title="Adding infrastructure nodes to an ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/add-infra-nodes/>Adding infrastructure nodes to an ARO cluster</a></li><li data-nav-id=/docs/aro/azure-policy/ title="Apply Azure Policy to Azure Policy" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-policy/>Apply Azure Policy to Azure Policy</a></li><li data-nav-id=/docs/aro/disaster-recovery/ title="ARO - Considerations for Disaster Recovery" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/disaster-recovery/>ARO - Considerations for Disaster Recovery</a></li><li data-nav-id=/docs/aro/cert-manager/ title="ARO Custom domain with cert-manager and LetsEncrypt" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/cert-manager/>ARO Custom domain with cert-manager and LetsEncrypt</a></li><li data-nav-id=/docs/aro/ibm-cloud-paks-for-data/ title="ARO IBM Cloud Paks 4 Data" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/ibm-cloud-paks-for-data/>ARO IBM Cloud Paks 4 Data</a></li><li data-nav-id=/docs/aro/gpu/ title="ARO with Nvidia GPU Workloads" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/gpu/>ARO with Nvidia GPU Workloads</a></li><li data-nav-id=/docs/aro/frontdoor/ title="Azure Front Door with ARO ( Azure Red Hat OpenShift )" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/frontdoor/>Azure Front Door with ARO ( Azure Red Hat OpenShift )</a></li><li data-nav-id=/docs/aro/azure-service-operator/ title="Azure Service Operator" class=dd-item><input type=checkbox id=section-c4973928d95ad0b6b86b8742709cea9d class=toggle><label for=section-c4973928d95ad0b6b86b8742709cea9d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/>Azure Service Operator</a><ul><li data-nav-id=/docs/aro/azure-service-operator/v1/ title="Azure Service Operator V1 in ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/v1/>Azure Service Operator V1 in ARO</a></li><li data-nav-id=/docs/aro/azure-service-operator/v2/ title="Azure Service Operator V2 in ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/v2/>Azure Service Operator V2 in ARO</a></li></ul></li><li data-nav-id=/docs/aro/managed-upgrade-operator/ title="Enable the Managed Upgrade Operator in ARO and schedule Upgrades" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/managed-upgrade-operator/>Enable the Managed Upgrade Operator in ARO and schedule Upgrades</a></li><li data-nav-id=/docs/aro/federated-metrics/ title="Federating System and User metrics to Azure Files in Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/federated-metrics/>Federating System and User metrics to Azure Files in Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/aro/aro-machinesets/readme/ title="Helm Chart to set up extra MachineSets on ARO clusters" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/aro-machinesets/readme/>Helm Chart to set up extra MachineSets on ARO clusters</a></li><li data-nav-id=/docs/aro/astronomer/ title="Installing Astronomer on a private ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/astronomer/>Installing Astronomer on a private ARO cluster</a></li><li data-nav-id=/docs/aro/azure-arc-integration/ title="Integrating Azure ARC with ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-arc-integration/>Integrating Azure ARC with ARO</a></li><li data-nav-id=/docs/aro/odf/ title="OpenShift Data Foundation with ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/odf/>OpenShift Data Foundation with ARO</a></li><li data-nav-id=/docs/aro/private-cluster/ title="Private ARO Cluster with access via JumpHost" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/private-cluster/>Private ARO Cluster with access via JumpHost</a></li><li data-nav-id=/docs/aro/setup-quay/ title="Quay on ARO" class=dd-item><input type=checkbox id=section-107cd49f6d91378e87d08e36d5f67445 class=toggle><label for=section-107cd49f6d91378e87d08e36d5f67445></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/>Quay on ARO</a><ul><li data-nav-id=/docs/aro/setup-quay/quay-cli/ title="Setting up Quay on an ARO cluster via CLI" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/quay-cli/>Setting up Quay on an ARO cluster via CLI</a></li><li data-nav-id=/docs/aro/setup-quay/quay-console/ title="Setting up Quay on an ARO cluster via Console" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/quay-console/>Setting up Quay on an ARO cluster via Console</a></li></ul></li><li data-nav-id=/docs/aro/ocm/ title="Registering an ARO cluster to OpenShift Cluster Manager" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/ocm/>Registering an ARO cluster to OpenShift Cluster Manager</a></li><li data-nav-id=/docs/aro/vpn/ title="Setup a VPN Connection into an ARO Cluster with OpenVPN" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/vpn/>Setup a VPN Connection into an ARO Cluster with OpenVPN</a></li><li data-nav-id=/docs/aro/trident/ title="Trident NetApp operator setup for Azure NetApp files" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/trident/>Trident NetApp operator setup for Azure NetApp files</a></li><li data-nav-id=/docs/aro/clf-to-azure/ title="Using Cluster Logging Forwarder in ARO with Azure Monitor" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/clf-to-azure/>Using Cluster Logging Forwarder in ARO with Azure Monitor</a></li><li data-nav-id=/docs/aro/egress-ipam-operator/ title="Using the Egressip Ipam Operator with a Private ARO Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/egress-ipam-operator/>Using the Egressip Ipam Operator with a Private ARO Cluster</a></li></ul></li><li data-nav-id=/docs/rosa/ title="Red Hat Openshift Service on AWS" class="dd-item parent"><input type=checkbox id=section-d82bea3b793597b6ff01917e2ad59aae class=toggle checked><label for=section-d82bea3b793597b6ff01917e2ad59aae></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/>Red Hat Openshift Service on AWS</a><ul><li data-nav-id=/docs/rosa/aws-load-balancer-operator/ title="AWS Load Balancer Operator On ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-load-balancer-operator/>AWS Load Balancer Operator On ROSA</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-vector/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/clf-cloudwatch-vector/>Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector</a></li><li data-nav-id=/docs/rosa/dynamic-certificates/ title="Dynamic Certificates for ROSA Custom Domain" class="dd-item active"><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/dynamic-certificates/>Dynamic Certificates for ROSA Custom Domain</a></li><li data-nav-id=/docs/rosa/static-ip-load-balancer/ title="Configure a load balancer service to use a static public IP" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/static-ip-load-balancer/>Configure a load balancer service to use a static public IP</a></li><li data-nav-id=/docs/rosa/verify-permissions/ title="Verify Permissions for ROSA STS Deployment" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/verify-permissions/>Verify Permissions for ROSA STS Deployment</a></li><li data-nav-id=/docs/rosa/sts-oidc-flow/ title="STS OIDC in ROSA : How it works!" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-oidc-flow/>STS OIDC in ROSA : How it works!</a></li><li data-nav-id=/docs/rosa/security-ra/ title="Security Reference Architecture for ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/security-ra/>Security Reference Architecture for ROSA</a></li><li data-nav-id=/docs/rosa/rosa-asea-landing-zone/ title="Integrating ROSA and ASEA Landing Zones" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/rosa-asea-landing-zone/>Integrating ROSA and ASEA Landing Zones</a></li><li data-nav-id=/docs/rosa/ecr/ title="Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr/>Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)</a></li><li data-nav-id=/docs/rosa/byo-vpc/ title="Creating a Public/Private BYO VPC for ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/byo-vpc/>Creating a Public/Private BYO VPC for ROSA</a></li><li data-nav-id=/docs/rosa/kms/ title="Creating a ROSA cluster in STS mode with custom KMS key" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/kms/>Creating a ROSA cluster in STS mode with custom KMS key</a></li><li data-nav-id=/docs/rosa/custom-alertmanager/ title="Custom Alerts in ROSA 4.11.x" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/custom-alertmanager/>Custom Alerts in ROSA 4.11.x</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/ title="ECR Secret Operator" class=dd-item><input type=checkbox id=section-d622abc3689c39008edcc95bca0300b1 class=toggle><label for=section-d622abc3689c39008edcc95bca0300b1></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/>ECR Secret Operator</a><ul><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_user/ title="Create IAM user and Policy" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/iam_user/>Create IAM user and Policy</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_assume_role/ title="Create STS Assume Role" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/iam_assume_role/>Create STS Assume Role</a></li></ul></li><li data-nav-id=/docs/rosa/aws-efs-csi-operator-sts/ title="Enabling the AWS EFS CSI Driver Operator on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-efs-csi-operator-sts/>Enabling the AWS EFS CSI Driver Operator on ROSA</a></li><li data-nav-id=/docs/rosa/waf/ title="Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS" class=dd-item><input type=checkbox id=section-6293c009b4929ddbd0c9b2918068ea94 class=toggle><label for=section-6293c009b4929ddbd0c9b2918068ea94></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/>Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS</a><ul><li data-nav-id=/docs/rosa/waf/alb/ title="This is a POC of ROSA with a AWS WAF service" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/alb/>This is a POC of ROSA with a AWS WAF service</a></li><li data-nav-id=/docs/rosa/waf/readme-complex/ title="This is a POC of ROSA with a AWS WAF service" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/readme-complex/>This is a POC of ROSA with a AWS WAF service</a></li><li data-nav-id=/docs/rosa/waf/cloud-front/ title="Using CloudFront + WAF" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/cloud-front/>Using CloudFront + WAF</a></li></ul></li><li data-nav-id=/docs/rosa/using-sts-with-aws-services/ title="Extending ROSA STS to include authentication with AWS Services" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/using-sts-with-aws-services/>Extending ROSA STS to include authentication with AWS Services</a></li><li data-nav-id=/docs/rosa/federated-metrics-prometheus/ title="Federating Metrics to a centralized Prometheus Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics-prometheus/>Federating Metrics to a centralized Prometheus Cluster</a></li><li data-nav-id=/docs/rosa/sts-and-pod-identity/ title="Integrating with AWS resources using Pod Identity" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-and-pod-identity/>Integrating with AWS resources using Pod Identity</a></li><li data-nav-id=/docs/rosa/cluster-metrics-to-aws-prometheus/ title="ROSA - Federating Metrics to AWS Prometheus" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/cluster-metrics-to-aws-prometheus/>ROSA - Federating Metrics to AWS Prometheus</a></li><li data-nav-id=/docs/rosa/aws-secrets-manager-csi/ title="Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-secrets-manager-csi/>Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS</a></li><li data-nav-id=/docs/rosa/metrics-to-cloudwatch-agent/ title="Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/metrics-to-cloudwatch-agent/>Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA</a></li><li data-nav-id=/docs/rosa/sts-cluster-logging-addon/ title="Work Around to fix the issue with the logging-addon on ROSA STS Clusters" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-cluster-logging-addon/>Work Around to fix the issue with the logging-addon on ROSA STS Clusters</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-sts/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs and STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/clf-cloudwatch-sts/>Configuring the Cluster Log Forwarder for CloudWatch Logs and STS</a></li><li data-nav-id=/docs/rosa/sts/ title="Creating a ROSA cluster in STS mode" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts/>Creating a ROSA cluster in STS mode</a></li><li data-nav-id=/docs/rosa/private-link/ title="Creating a ROSA cluster with Private Link enabled" class=dd-item><input type=checkbox id=section-71f53e8bae0a034c83f5c2f0c7c9c315 class=toggle><label for=section-71f53e8bae0a034c83f5c2f0c7c9c315></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/private-link/>Creating a ROSA cluster with Private Link enabled</a><ul><li data-nav-id=/docs/rosa/private-link/public-ingress/ title="Adding a Public Ingress endpoint to a ROSA Private-Link Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/private-link/public-ingress/>Adding a Public Ingress endpoint to a ROSA Private-Link Cluster</a></li></ul></li><li data-nav-id=/docs/rosa/sts-with-private-link/ title="Creating a ROSA cluster with Private Link enabled (custom VPC) and STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-with-private-link/>Creating a ROSA cluster with Private Link enabled (custom VPC) and STS</a></li><li data-nav-id=/docs/rosa/custom-alertmanager-4.9/ title="Custom AlertManager in ROSA 4.9.x" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/custom-alertmanager-4.9/>Custom AlertManager in ROSA 4.9.x</a></li><li data-nav-id=/docs/rosa/aws-efs-operator-on-rosa/ title="Enabling the AWS EFS Operator on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-efs-operator-on-rosa/>Enabling the AWS EFS Operator on ROSA</a></li><li data-nav-id=/docs/rosa/federated-metrics/ title="Federating System and User metrics to S3 in Red Hat OpenShift for AWS" class=dd-item><input type=checkbox id=section-9567eab834a47ae397393da72ca0280d class=toggle><label for=section-9567eab834a47ae397393da72ca0280d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics/>Federating System and User metrics to S3 in Red Hat OpenShift for AWS</a><ul><li data-nav-id=/docs/rosa/federated-metrics/user-defined/ title="User Workload Monitoring on Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics/user-defined/>User Workload Monitoring on Azure Red Hat OpenShift</a></li></ul></li><li data-nav-id=/docs/rosa/ack/ title="Using AWS Controllers for Kubernetes (ACK) on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ack/>Using AWS Controllers for Kubernetes (ACK) on ROSA</a></li></ul></li><li data-nav-id=/docs/idp/ title="Configuring IDP for ROSA and OSD" class=dd-item><input type=checkbox id=section-de867ba7872b33ba38d343e5be5e3e1c class=toggle><label for=section-de867ba7872b33ba38d343e5be5e3e1c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/>Configuring IDP for ROSA and OSD</a><ul><li data-nav-id=/docs/idp/okta-grp-sync/ title="Using Group Sync Operator with Okta and ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/okta-grp-sync/>Using Group Sync Operator with Okta and ROSA/OSD</a></li><li data-nav-id=/docs/idp/azuread-aro/ title="Configure ARO to use Azure AD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread-aro/>Configure ARO to use Azure AD</a></li><li data-nav-id=/docs/idp/azuread-aro-cli/ title="Configure Azure AD as an OIDC identity provider for ARO with cli" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread-aro-cli/>Configure Azure AD as an OIDC identity provider for ARO with cli</a></li><li data-nav-id=/docs/idp/azuread/ title="Configure Azure AD as an OIDC identity provider for ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread/>Configure Azure AD as an OIDC identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/gitlab-aro/ title="Configure GitLab as an identity provider for ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/gitlab-aro/>Configure GitLab as an identity provider for ARO</a></li><li data-nav-id=/docs/idp/gitlab/ title="Configure GitLab as an identity provider for ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/gitlab/>Configure GitLab as an identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/az-ad-grp-sync/ title="Using Group Sync Operator with Azure Active Directory and ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/az-ad-grp-sync/>Using Group Sync Operator with Azure Active Directory and ROSA</a></li><li data-nav-id=/docs/idp/group-claims/ title="MOBB Docs and Guides - group-claims" class=dd-item><input type=checkbox id=section-af199904c6a78739e6598ab72890c976 class=toggle><label for=section-af199904c6a78739e6598ab72890c976></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/>MOBB Docs and Guides - group-claims</a><ul><li data-nav-id=/docs/idp/group-claims/rosa/ title="Configure ROSA to use Azure AD Group Claims" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/rosa/>Configure ROSA to use Azure AD Group Claims</a></li><li data-nav-id=/docs/idp/group-claims/aro/ title="Configure ARO to use Azure AD Group Claims" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/aro/>Configure ARO to use Azure AD Group Claims</a></li></ul></li></ul></li><li data-nav-id=/docs/misc/ title=Miscellaneous class=dd-item><input type=checkbox id=section-4743293995ef089d075c101a4e477e5c class=toggle><label for=section-4743293995ef089d075c101a4e477e5c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/>Miscellaneous</a><ul><li data-nav-id=/docs/misc/tls-cipher-customization/ title="Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/tls-cipher-customization/>Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers</a></li><li data-nav-id=/docs/misc/jup/ title="Jupyter Notebooks" class=dd-item><input type=checkbox id=section-7af6414e26181825f2ee42d2fad956be class=toggle><label for=section-7af6414e26181825f2ee42d2fad956be></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/>Jupyter Notebooks</a><ul><li data-nav-id=/docs/misc/jup/buildnotebook/ title="How to deploy Jupyter Notebook" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/buildnotebook/>How to deploy Jupyter Notebook</a></li><li data-nav-id=/docs/misc/jup/opendatahub-gpu/ title="Installing the Open Data Hub Operator" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/opendatahub-gpu/>Installing the Open Data Hub Operator</a></li></ul></li><li data-nav-id=/docs/misc/default-router-custom-domain/ title="Stop default router from serving custom domain routes" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/default-router-custom-domain/>Stop default router from serving custom domain routes</a></li><li data-nav-id=/docs/misc/references/ title="Common Managed OpenShift References / Tasks" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/references/>Common Managed OpenShift References / Tasks</a></li><li data-nav-id=/docs/misc/secrets-store-csi/ title="Installing the Kubernetes Secret Store CSI on OpenShift" class=dd-item><input type=checkbox id=section-83dcfc1bac9347003164dd6ca6bb9da6 class=toggle><label for=section-83dcfc1bac9347003164dd6ca6bb9da6></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/>Installing the Kubernetes Secret Store CSI on OpenShift</a><ul><li data-nav-id=/docs/misc/secrets-store-csi/azure-key-vault/ title="Azure Key Vault CSI on Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/azure-key-vault/>Azure Key Vault CSI on Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/misc/secrets-store-csi/hashicorp-vault/ title="Installing the HashiCorp Vault Secret CSI Driver" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/hashicorp-vault/>Installing the HashiCorp Vault Secret CSI Driver</a></li></ul></li><li data-nav-id=/docs/misc/common-images-namespace/ title="OpenShift - Sharing Common images" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/common-images-namespace/>OpenShift - Sharing Common images</a></li><li data-nav-id=/docs/misc/cost-management/ title="Red Hat Cost Management for Cloud Services" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/cost-management/>Red Hat Cost Management for Cloud Services</a></li><li data-nav-id=/docs/misc/oadp/ title="MOBB Docs and Guides - oadp" class=dd-item><input type=checkbox id=section-325dd7bf30613094ac338d7da82aacea class=toggle><label for=section-325dd7bf30613094ac338d7da82aacea></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/oadp/>MOBB Docs and Guides - oadp</a><ul><li data-nav-id=/docs/misc/oadp/rosa-sts/ title="Deploying OpenShift Advanced Data Protection on a ROSA cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/oadp/rosa-sts/>Deploying OpenShift Advanced Data Protection on a ROSA cluster</a></li></ul></li></ul></li><li data-nav-id=/docs/o11y/ title=Observability class=dd-item><input type=checkbox id=section-cf64d50e30bf8c808e1a384a9dd9f94e class=toggle><label for=section-cf64d50e30bf8c808e1a384a9dd9f94e></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/>Observability</a><ul><li data-nav-id=/docs/o11y/openshift-logging/ title="OpenShift Logging" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/openshift-logging/>OpenShift Logging</a></li><li data-nav-id=/docs/o11y/az-log-analytics/ title="Shipping logs to Azure Log Analytics" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/az-log-analytics/>Shipping logs to Azure Log Analytics</a></li></ul></li><li data-nav-id=/docs/gcp/ title="OSD on Google Cloud" class=dd-item><input type=checkbox id=section-34c34dd71fe103bc20cfa9eed6fa905c class=toggle><label for=section-34c34dd71fe103bc20cfa9eed6fa905c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/>OSD on Google Cloud</a><ul><li data-nav-id=/docs/gcp/filestore/ title="Create Filestore Storage for OSD in GCP" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/filestore/>Create Filestore Storage for OSD in GCP</a></li><li data-nav-id=/docs/gcp/osd_preexisting_vpc/ title="Creating a OSD in GCP with Existing VPCs" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/osd_preexisting_vpc/>Creating a OSD in GCP with Existing VPCs</a></li></ul></li><li data-nav-id=/docs/redhat/ title="Other Red Hat Products" class=dd-item><input type=checkbox id=section-61ee77d4a0d9667d2a6b99ce46059f1d class=toggle><label for=section-61ee77d4a0d9667d2a6b99ce46059f1d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/>Other Red Hat Products</a><ul><li data-nav-id=/docs/redhat/gitops/ title="Demonstrate GitOps on Managed OpenShift with ArgoCD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/gitops/>Demonstrate GitOps on Managed OpenShift with ArgoCD</a></li><li data-nav-id=/docs/redhat/3scale/ title="Deploying 3scale API Management to ROSA and OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/3scale/>Deploying 3scale API Management to ROSA and OSD</a></li><li data-nav-id=/docs/redhat/rhacs/ title="Deploying Red Hat Advanced Cluster Security in ARO/ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/rhacs/>Deploying Red Hat Advanced Cluster Security in ARO/ROSA</a></li><li data-nav-id=/docs/redhat/crane/ title="Migrate Kubernetes Applications with Konveyer Crane" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/crane/>Migrate Kubernetes Applications with Konveyer Crane</a></li><li data-nav-id=/docs/redhat/acm/ title="Advanced Cluster Management" class=dd-item><input type=checkbox id=section-d7942abe72cdf38022f3b7c824316905 class=toggle><label for=section-d7942abe72cdf38022f3b7c824316905></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/>Advanced Cluster Management</a><ul><li data-nav-id=/docs/redhat/acm/observability/ title="Advanced Cluster Management - Observability" class=dd-item><input type=checkbox id=section-16c8cbcc1de529ce480045089e9bde5c class=toggle><label for=section-16c8cbcc1de529ce480045089e9bde5c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/observability/>Advanced Cluster Management - Observability</a><ul><li data-nav-id=/docs/redhat/acm/observability/rosa/ title="Advanced Cluster Management Observability on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/observability/rosa/>Advanced Cluster Management Observability on ROSA</a></li></ul></li></ul></li></ul></li></ul></li></ul><div id=shortcuts><div class=nav-title></div><ul><li><a class=padding href=https://github.com/rh-mobb/documentation target=_blank><i class='fab fa-fw fa-github'></i> Github</a></li><li><a class=padding href=https://github.com/rh-mobb/documentation/archive/refs/heads/main.zip target=_blank><i class='fas fa-fw fa-file-download'></i> Download</a></li><li><a class=padding href=https://www.redhat.com/en/blog target=_blank><i class='fab fa-fw fa-redhat'></i> Red Hat Blog</a></li><li><a class=padding href=https://rh-mobb.github.io/mobb_ninja/tags/ target=_blank><i class='fas fa-fw fa-tags'></i> Tags</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><a class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></a></li><li id=select-variant-container class=footerVariantSwitch><a class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=red value=red selected>Red</option></select></div><div class=select-clear></div></a><script>window.variants&&variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><a class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=https://rh-mobb.github.io/mobb_ninja/js/clipboard.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/perfect-scrollbar.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/featherlight.min.js?1673630121 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/theme.js?1673630121 defer></script></body></html>