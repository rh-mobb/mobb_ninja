<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="height=device-height,width=device-width,initial-scale=1,minimum-scale=1"><meta name=generator content="Hugo 0.109.0"><meta name=generator content="Relearn 5.2.3+tip"><meta name=description content><title>Azure Front Door with ARO ( Azure Red Hat OpenShift ) :: Managed OpenShift Black Belt - Unofficial Documentation</title><link href=https://rh-mobb.github.io/mobb_ninja/docs/aro/frontdoor/index.xml rel=alternate type=application/rss+xml title="Managed OpenShift Black Belt - Unofficial Documentation"><link href=https://rh-mobb.github.io/mobb_ninja/css/fontawesome-all.min.css?1673630122 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/fontawesome-all.min.css?1673630122 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/featherlight.min.css?1673630122 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/featherlight.min.css?1673630122 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/auto-complete.css?1673630122 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/auto-complete.css?1673630122 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/perfect-scrollbar.min.css?1673630122 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/nucleus.css?1673630122 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/fonts.css?1673630122 rel=stylesheet media=print onload='this.media="all",this.onload=null'><noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/fonts.css?1673630122 rel=stylesheet></noscript><link href=https://rh-mobb.github.io/mobb_ninja/css/theme.css?1673630122 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/theme-red.css?1673630122 rel=stylesheet id=variant-style><link href=https://rh-mobb.github.io/mobb_ninja/css/ie.css?1673630122 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/variant.css?1673630122 rel=stylesheet><link href=https://rh-mobb.github.io/mobb_ninja/css/print.css?1673630122 rel=stylesheet media=print><script src=https://rh-mobb.github.io/mobb_ninja/js/variant.js?1673630122></script>
<script>var index_url="https://rh-mobb.github.io/mobb_ninja/index.json",baseUriFull,root_url="https://rh-mobb.github.io/mobb_ninja/",baseUri=root_url.replace(/\/$/,"");window.T_Copy_to_clipboard="Copy to clipboard",window.T_Copied_to_clipboard="Copied to clipboard!",window.T_Copy_link_to_clipboard="Copy link to clipboard",window.T_Link_copied_to_clipboard="Copied link to clipboard!",baseUriFull="https://rh-mobb.github.io/mobb_ninja/",window.variants&&variants.init(["red"])</script><script src=https://rh-mobb.github.io/mobb_ninja/js/jquery.min.js?1673630122 defer></script></head><body class="mobile-support html" data-url=https://rh-mobb.github.io/mobb_ninja/docs/aro/frontdoor/><div id=body class=default-animation><div id=sidebar-overlay></div><div id=toc-overlay></div><nav id=topbar class=highlightable><div><div class=navigation><a class="nav nav-next" href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/ title="Azure Service Operator (&#129106;)"><i class="fas fa-chevron-right fa-fw"></i></a></div><div class=navigation><a class="nav nav-prev" href=https://rh-mobb.github.io/mobb_ninja/docs/aro/gpu/ title="ARO with Nvidia GPU Workloads (&#129104;)"><i class="fas fa-chevron-left fa-fw"></i></a></div><div id=breadcrumbs><span id=sidebar-toggle-span><a href=# id=sidebar-toggle title='Menu (CTRL+ALT+m)'><i class="fas fa-bars fa-fw"></i></a></span>
<span id=toc-menu title='Table of Contents (CTRL+ALT+t)'><i class="fas fa-list-alt fa-fw"></i></span><ol class=links itemscope itemtype=http://schema.org/BreadcrumbList><meta itemprop=itemListOrder content="Descending"><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="4"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="3"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/><span itemprop=name>Documentation from the MOBB</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="2"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/aro/><span itemprop=name>Azure Red Hat OpenShift</span></a> ></li><li itemscope itemtype=https://schema.org/ListItem itemprop=itemListElement><meta itemprop=position content="1"><a itemprop=item href=https://rh-mobb.github.io/mobb_ninja/docs/aro/frontdoor/ aria-disabled=true><span itemprop=name>Azure Front Door with ARO ( Azure Red Hat OpenShift )</span></a></li></ol></div><div class="default-animation progress"><div class=wrapper><nav id=TableOfContents><ul><li><a href=#prerequisites>Prerequisites</a></li><li><a href=#get-started>Get Started</a></li><li><a href=#set-evironment-variables>Set Evironment Variables</a></li><li><a href=#create-a-private-link-service>Create a Private Link Service</a></li><li><a href=#create-and-configure-an-instance-of-azure-front-door>Create and Configure an instance of Azure Front Door</a></li><li><a href=#deploy-an-application>Deploy an application</a></li><li><a href=#deploy-the-minesweeper-applicationhttpsgithubcomredhat-mw-demosmicrosweeper-quarkustreearo>Deploy the <a href=https://github.com/redhat-mw-demos/microsweeper-quarkus/tree/ARO>minesweeper application</a></a></li><li><a href=#test-the-application>Test the application</a></li><li><a href=#clean-up>Clean up</a></li></ul></nav></div></div></div></nav><main id=body-inner class="highlightable default" tabindex=-1><div class=flex-block-wrapper><div id=head-tags><div class=tags><a class=tag-link href=https://rh-mobb.github.io/mobb_ninja/tags/aro>ARO</a>
<a class=tag-link href=https://rh-mobb.github.io/mobb_ninja/tags/azure>Azure</a></div></div><style>.alert{padding:15px;margin-bottom:20px;border:1px solid transparent;border-radius:4px}.alert-warning{background-color:#fcf8e3;border-color:#fbeed5;color:#c09853}</style><p class="alert alert-warning"><b>IMPORTANT NOTE</b>: This site is not official Red Hat documentation and is provided for informational purposes only. These guides may be experimental, proof of concept, or early adoption. Officially supported documentation is available at <a href=https://docs.openshift.com target=_blank>docs.openshift.com</a> and <a href=https://access.redhat.com target=_blank>access.redhat.com</a>.</p><article class=default><h1>Azure Front Door with ARO ( Azure Red Hat OpenShift )</h1><p>Securing exposing an Internet facing application with a private ARO Cluster.</p><p>When you create a cluster on ARO you have several options in making the cluster public or private. With a public cluster you are allowing Internet traffic to the api and *.apps endpoints. With a private cluster you can make either or both the api and .apps endpoints private.</p><p>How can you allow Internet access to an application running on your private cluster where the .apps endpoint is private? This document will guide you through using Azure Frontdoor to expose your applications to the Internet. There are several advantages of this approach, namely your cluster and all the resources in your Azure account can remain private, providing you an extra layer of security. Azure FrontDoor operates at the edge so we are controlling traffic before it even gets into your Azure account. On top of that, Azure FrontDoor also offers WAF and DDoS protection, certificate management and SSL Offloading just to name a few benefits.</p><p><strong>Kevin Collins</strong> <em>06/16/2022</em></p><p><em>Adopted from <a href=https://github.com/UmarMohamedUsman/aro-reference-architecture>ARO Reference Architecture</a></em></p><h2 id=prerequisites>Prerequisites</h2><ul><li>az cli</li><li>oc cli</li><li>a custom domain</li><li>a DNS zone that you can easily modify<br></li></ul><p>To build and deploy the application</p><ul><li><a href=https://maven.apache.org/install.html>maven cli</a></li><li><a href=https://quarkus.io/guides/cli-tooling>quarkus cli</a></li><li><a href="https://www.azul.com/downloads/?package=jdk">OpenJDK Java 8</a></li></ul><p>Make sure to use the same terminal session while going through guide for all commands as we will reference envrionment variables set or created through the guide.</p><h2 id=get-started>Get Started</h2><ul><li><p>Create a private ARO cluster.</p><p>Follow this guide to <a href=https://mobb.ninja/docs/aro/private-cluster>Create a private ARO cluster</a>
or simply run this <a href=https://github.com/rh-mobb/documentation/blob/main/docs/aro/private-cluster/create-cluster.sh>bash script</a></p></li></ul><h2 id=set-evironment-variables>Set Evironment Variables</h2><ol><li><p>Manually set environment variables</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>AROCLUSTER=&lt;cluster name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ARORG=&lt;resource group for the cluster&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AFD_NAME=&lt;name you want to use for the front door instance&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>DOMAIN=&#39;e.g. aro.kmobb.com&#39;  This is the domain that you will be adding to Azure DNS to manage.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ARO_APP_FQDN=&#39;e.g. minesweeper.aro.kmobb.com&#39;
</span></span><span style=display:flex><span>(note - we will be deploying an application called minesweeper to test front door.  Select a domain you would like to use for the application.  For example minesweeper.aro.kmobb.com ... where aro.kmobb.com is the domain you manage and have DNS access to.)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>AFD_MINE_CUSTOM_DOMAIN_NAME=&#39;minesweeper-aro-kmobb-com&#39;
</span></span><span style=display:flex><span>(note - this should be your domain name without and .&#39;s for example minesweeper-aro-kmobb-com)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PRIVATEENDPOINTSUBNET_PREFIX= subnet in the VNET you cluster is in.  If you following the example above to create a custer where you virtual network is 10.0.0.0/20 then you can use &#39;10.0.6.0/24&#39;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>PRIVATEENDPOINTSUBNET_NAME=&#39;PrivateEndpoint-subnet&#39;
</span></span></code></pre></div></li><li><p>Set environment variables with Bash</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>UNIQUEID<span style=color:#f92672>=</span>$RANDOM
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ARO_RGNAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show -n $AROCLUSTER -g $ARORG --query <span style=color:#e6db74>&#34;clusterProfile.resourceGroupId&#34;</span> -o tsv | sed <span style=color:#e6db74>&#39;s/.*\///&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LOCATION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show --name $AROCLUSTER --resource-group $ARORG --query location -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>INTERNAL_LBNAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network lb list --resource-group $ARO_RGNAME --query <span style=color:#e6db74>&#34;[? contains(name, &#39;internal&#39;)].name&#34;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WORKER_SUBNET_NAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show --name $AROCLUSTER --resource-group $ARORG --query <span style=color:#e6db74>&#39;workerProfiles[0].subnetId&#39;</span> -o tsv | sed <span style=color:#e6db74>&#39;s/.*\///&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WORKER_SUBNET_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show --name $AROCLUSTER --resource-group $ARORG --query <span style=color:#e6db74>&#39;workerProfiles[0].subnetId&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>VNET_NAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network vnet list -g $ARORG --query <span style=color:#e6db74>&#39;[0].name&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LBCONFIG_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network lb frontend-ip list -g $ARO_RGNAME --lb-name $INTERNAL_LBNAME --query <span style=color:#e6db74>&#34;[? contains(subnet.id,&#39;</span>$WORKER_SUBNET_ID<span style=color:#e6db74>&#39;)].id&#34;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>LBCONFIG_IP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network lb frontend-ip list -g $ARO_RGNAME --lb-name $INTERNAL_LBNAME --query <span style=color:#e6db74>&#34;[? contains(subnet.id,&#39;</span>$WORKER_SUBNET_ID<span style=color:#e6db74>&#39;)].privateIpAddress&#34;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li></ol><h2 id=create-a-private-link-service>Create a Private Link Service</h2><p>After we have the cluster up and running, we need to create a private link service. The private link service will provide private and secure connectivity between the Front Door Service and our cluster.</p><ol><li><p>Disable the worker subnet private link service network policy for the worker subnet</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet update <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--disable-private-link-service-network-policies true <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name $WORKER_SUBNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--vnet-name $VNET_NAME
</span></span></code></pre></div></li><li><p>Create a private link service targeting the worker subnets</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network private-link-service create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name $AROCLUSTER-pls <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-ip-address-version IPv4 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-ip-allocation-method Dynamic <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--vnet-name $VNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--subnet $WORKER_SUBNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--lb-frontend-ip-configs $LBCONFIG_ID
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>privatelink_id<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network private-link-service show -n $AROCLUSTER-pls -g $ARORG --query <span style=color:#e6db74>&#39;id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li></ol><h2 id=create-and-configure-an-instance-of-azure-front-door>Create and Configure an instance of Azure Front Door</h2><ol><li><p>Create a Front Door Instance</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd profile create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--sku Premium_AzureFrontDoor
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>afd_id<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az afd profile show -g $ARORG --profile-name $AFD_NAME --query <span style=color:#e6db74>&#39;id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Create an endpoint for the ARO Internal Load Balancer</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd endpoint create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--enabled-state Enabled <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--endpoint-name <span style=color:#e6db74>&#39;aro-ilb&#39;</span>$UNIQUEID <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME
</span></span></code></pre></div></li><li><p>Create a Front Door Origin Group that will point to the ARO Internal Loadbalancer</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd origin-group create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--origin-group-name <span style=color:#e6db74>&#39;afdorigin&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--probe-path <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--probe-protocol Http <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--probe-request-type GET <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--probe-interval-in-seconds <span style=color:#ae81ff>100</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--probe-interval-in-seconds <span style=color:#ae81ff>120</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--sample-size <span style=color:#ae81ff>4</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--successful-samples-required <span style=color:#ae81ff>3</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--additional-latency-in-milliseconds <span style=color:#ae81ff>50</span>
</span></span></code></pre></div></li><li><p>Create a Front Door Origin with the above Origin Group that will point to the ARO Internal Loadbalancer</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd origin create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--enable-private-link true <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-link-resource $privatelink_id <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-link-location $LOCATION <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-link-request-message <span style=color:#e6db74>&#39;Private link service from AFD&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--weight <span style=color:#ae81ff>1000</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--priority <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--http-port <span style=color:#ae81ff>80</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--https-port <span style=color:#ae81ff>443</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--origin-group-name <span style=color:#e6db74>&#39;afdorigin&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--enabled-state Enabled <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--host-name $LBCONFIG_IP <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--origin-name <span style=color:#e6db74>&#39;afdorigin&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG
</span></span></code></pre></div></li><li><p>Approve the private link connection</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>privatelink_pe_id<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network private-link-service show -n $AROCLUSTER-pls -g $ARORG --query <span style=color:#e6db74>&#39;privateEndpointConnections[0].id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-endpoint-connection approve <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--description <span style=color:#e6db74>&#39;Approved&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--id $privatelink_pe_id
</span></span></code></pre></div></li><li><p>Add your custom domain to Azure Front Door</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd custom-domain create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--certificate-type ManagedCertificate <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--custom-domain-name $AFD_MINE_CUSTOM_DOMAIN_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--host-name $ARO_APP_FQDN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--minimum-tls-version TLS12 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG
</span></span></code></pre></div></li><li><p>Create an Azure Front Door endpoint for your custom domain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd endpoint create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--enabled-state Enabled <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--endpoint-name <span style=color:#e6db74>&#39;aro-mine-&#39;</span>$UNIQUEID <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME
</span></span></code></pre></div></li><li><p>Add an Azure Front Door route for your custom domain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd route create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--endpoint-name <span style=color:#e6db74>&#39;aro-mine-&#39;</span>$UNIQUEID <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--forwarding-protocol HttpOnly <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--https-redirect Disabled <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--origin-group <span style=color:#e6db74>&#39;afdorigin&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--route-name <span style=color:#e6db74>&#39;aro-mine-route&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--supported-protocols Http Https <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--patterns-to-match <span style=color:#e6db74>&#39;/*&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--custom-domains $AFD_MINE_CUSTOM_DOMAIN_NAME
</span></span></code></pre></div></li><li><p>Update DNS</p><p>Get a validation token from Front Door so Front Door can validate your domain</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>afdToken<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az afd custom-domain show <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--profile-name $AFD_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--custom-domain-name $AFD_MINE_CUSTOM_DOMAIN_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--query <span style=color:#e6db74>&#34;validationProperties.validationToken&#34;</span><span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Create a DNS Zone</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span> az network dns zone create -g $ARORG -n $DOMAIN
</span></span></code></pre></div><blockquote><p>You will need to configure your nameservers to point to azure. The output of running this zone create will show you the nameservers for this record that you will need to set up within your domain registrar.</p></blockquote><p>Create a new text record in your DNS server</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span> az network dns record-set txt add-record -g $ARORG -z $DOMAIN -n _dnsauth.<span style=color:#66d9ef>$(</span>echo $ARO_APP_FQDN | sed <span style=color:#e6db74>&#39;s/\..*//&#39;</span><span style=color:#66d9ef>)</span> --value $afdToken --record-set-name _dnsauth.<span style=color:#66d9ef>$(</span>echo $ARO_APP_FQDN | sed <span style=color:#e6db74>&#39;s/\..*//&#39;</span><span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Check if the domain has been validated:</p><blockquote><p>Note this can take several hours
Your FQDN will not resolve until Front Door validates your domain.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az afd custom-domain list -g $ARORG --profile-name $AFD_NAME --query <span style=color:#e6db74>&#34;[? contains(hostName, &#39;</span>$ARO_APP_FQDN<span style=color:#e6db74>&#39;)].domainValidationState&#34;</span>
</span></span></code></pre></div></li><li><p>Add a CNAME record to DNS</p><p>Get the Azure Front Door endpoint:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>afdEndpoint<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az afd endpoint show -g $ARORG --profile-name $AFD_NAME --endpoint-name aro-mine-$UNIQUEID --query <span style=color:#e6db74>&#34;hostName&#34;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div><p>Create a cname record for the application</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network dns record-set cname set-record -g $ARORG -z $DOMAIN <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span> -n <span style=color:#66d9ef>$(</span>echo $ARO_APP_FQDN | sed <span style=color:#e6db74>&#39;s/\..*//&#39;</span><span style=color:#66d9ef>)</span> -z $DOMAIN -c $afdEndpoint
</span></span></code></pre></div></li></ol><h2 id=deploy-an-application>Deploy an application</h2><p>Now the fun part, let&rsquo;s deploy an application!
We will be deploying a Java based application called <a href=https://github.com/redhat-mw-demos/microsweeper-quarkus/tree/ARO>microsweeper</a>. This is an application that runs on OpenShift and uses a PostgreSQL database to store scores. With ARO being a first class service on Azure, we will create an Azure Database for PostgreSQL service and connect it to our cluster with a private endpoint.</p><ol><li><p>Create a Azure Database for PostgreSQL servers service</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az postgres server create --name microsweeper-database --resource-group $ARORG --location $LOCATION --admin-user quarkus --admin-password r3dh4t1! --sku-name GP_Gen5_2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>POSTGRES_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az postgres server show -n microsweeper-database -g $ARORG --query <span style=color:#e6db74>&#39;id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span></code></pre></div></li><li><p>Create a private endpoint connection for the database</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network vnet subnet create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--vnet-name $VNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name $PRIVATEENDPOINTSUBNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--address-prefixes $PRIVATEENDPOINTSUBNET_PREFIX <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--disable-private-endpoint-network-policies true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-endpoint create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name <span style=color:#e6db74>&#39;postgresPvtEndpoint&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--vnet-name $VNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--subnet $PRIVATEENDPOINTSUBNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-connection-resource-id $POSTGRES_ID <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--group-id <span style=color:#e6db74>&#39;postgresqlServer&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--connection-name <span style=color:#e6db74>&#39;postgresdbConnection&#39;</span>
</span></span></code></pre></div></li><li><p>Create and configure a private DNS Zone for the Postgres database</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az network private-dns zone create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name <span style=color:#e6db74>&#39;privatelink.postgres.database.azure.com&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-dns link vnet create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--zone-name <span style=color:#e6db74>&#39;privatelink.postgres.database.azure.com&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name <span style=color:#e6db74>&#39;PostgresDNSLink&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--virtual-network $VNET_NAME <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--registration-enabled false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-endpoint dns-zone-group create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name <span style=color:#e6db74>&#39;PostgresDb-ZoneGroup&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--endpoint-name <span style=color:#e6db74>&#39;postgresPvtEndpoint&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--private-dns-zone <span style=color:#e6db74>&#39;privatelink.postgres.database.azure.com&#39;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--zone-name <span style=color:#e6db74>&#39;postgresqlServer&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>NETWORK_INTERFACE_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network private-endpoint show --name postgresPvtEndpoint --resource-group $ARORG --query <span style=color:#e6db74>&#39;networkInterfaces[0].id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>POSTGRES_IP<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az resource show --ids $NETWORK_INTERFACE_ID --api-version 2019-04-01 --query <span style=color:#e6db74>&#39;properties.ipConfigurations[0].properties.privateIPAddress&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-dns record-set a create --name $UNIQUEID-microsweeper-database --zone-name privatelink.postgres.database.azure.com --resource-group $ARORG
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az network private-dns record-set a add-record --record-set-name $UNIQUEID-microsweeper-database --zone-name privatelink.postgres.database.azure.com --resource-group $ARORG -a $POSTGRES_IP
</span></span></code></pre></div></li><li><p>Create a postgres database that will contain scores for the minesweeper application</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az postgres db create <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--resource-group $ARORG <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--name score <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>--server-name microsweeper-database
</span></span></code></pre></div></li></ol><h2 id=deploy-the-minesweeper-applicationhttpsgithubcomredhat-mw-demosmicrosweeper-quarkustreearo>Deploy the <a href=https://github.com/redhat-mw-demos/microsweeper-quarkus/tree/ARO>minesweeper application</a></h2><ol><li><p>Clone the git repository</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>git clone -b ARO https://github.com/redhat-mw-demos/microsweeper-quarkus.git
</span></span></code></pre></div></li><li><p>change to the root directory</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>cd microsweeper-quarkus
</span></span></code></pre></div></li><li><p>Ensure Java 1.8 is set at your Java version</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>mvn --version
</span></span></code></pre></div><p>Look for Java version - 1.8XXXX
if not set to Java 1.8 you will need to set your JAVA_HOME variable to Java 1.8 you have installed. To find your java versions run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>java -version
</span></span></code></pre></div><p>then export your JAVA_HOME variable</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>export JAVA_HOME<span style=color:#f92672>=</span><span style=color:#e6db74>`</span>/usr/libexec/java_home -v 1.8.0_332<span style=color:#e6db74>`</span>
</span></span></code></pre></div></li><li><p>Log into your openshift cluster</p><blockquote><p>Before you deploy your application, you will need to be connected to a private network that has access to the cluster.</p></blockquote><p>A great way to establish this connectity is with a VPN connection. Follow this <a href=../vpn/README.md>guide</a> to setup a VPN connection with your Azure account.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>kubeadmin_password<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro list-credentials --name $AROCLUSTER --resource-group $ARORG --query kubeadminPassword --output tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>apiServer<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az aro show -g $ARORG -n $AROCLUSTER --query apiserverProfile.url -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>oc login $apiServer -u kubeadmin -p $kubeadmin_password
</span></span></code></pre></div></li><li><p>Create a new OpenShift Project</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>oc new-project minesweeper
</span></span></code></pre></div></li><li><p>add the openshift extension to quarkus</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>quarkus ext add openshift
</span></span></code></pre></div></li><li><p>Edit microsweeper-quarkus/src/main/resources/application.properties</p><p>Make sure your file looks like the one below, changing the IP address on line 3 to the private ip address of your postgres instance.</p><p>To find your Postgres private IP address run the following commands:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>NETWORK_INTERFACE_ID<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>az network private-endpoint show --name postgresPvtEndpoint --resource-group $ARORG --query <span style=color:#e6db74>&#39;networkInterfaces[0].id&#39;</span> -o tsv<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>az resource show --ids $NETWORK_INTERFACE_ID --api-version 2019-04-01 --query <span style=color:#e6db74>&#39;properties.ipConfigurations[0].properties.privateIPAddress&#39;</span> -o tsv
</span></span></code></pre></div><p>Sample microsweeper-quarkus/src/main/resources/application.properties</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span># Database configurations
</span></span><span style=display:flex><span>%prod.quarkus.datasource.db-kind=postgresql
</span></span><span style=display:flex><span>%prod.quarkus.datasource.jdbc.url=jdbc:postgresql://10.1.6.9:5432/score
</span></span><span style=display:flex><span>%prod.quarkus.datasource.jdbc.driver=org.postgresql.Driver
</span></span><span style=display:flex><span>%prod.quarkus.datasource.username=quarkus@microsweeper-database
</span></span><span style=display:flex><span>%prod.quarkus.datasource.password=r3dh4t1!
</span></span><span style=display:flex><span>%prod.quarkus.hibernate-orm.database.generation=drop-and-create
</span></span><span style=display:flex><span>%prod.quarkus.hibernate-orm.database.generation=update
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># OpenShift configurations
</span></span><span style=display:flex><span>%prod.quarkus.kubernetes-client.trust-certs=true
</span></span><span style=display:flex><span>%prod.quarkus.kubernetes.deploy=true
</span></span><span style=display:flex><span>%prod.quarkus.kubernetes.deployment-target=openshift
</span></span><span style=display:flex><span>#%prod.quarkus.kubernetes.deployment-target=knative
</span></span><span style=display:flex><span>%prod.quarkus.openshift.build-strategy=docker
</span></span><span style=display:flex><span>#%prod.quarkus.openshift.expose=true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># Serverless configurations
</span></span><span style=display:flex><span>#%prod.quarkus.container-image.group=microsweeper-%prod.quarkus
</span></span><span style=display:flex><span>#%prod.quarkus.container-image.registry=image-registry.openshift-image-registry.svc:5000
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span># macOS configurations
</span></span><span style=display:flex><span>#%prod.quarkus.native.container-build=true
</span></span></code></pre></div></li><li><p>Build and deploy the quarkus application to OpenShift</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>quarkus build --no-tests
</span></span></code></pre></div></li><li><p>Create a route to your custom domain
<b>Change the snippet below replacing your hostname for the host:</b></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#e6db74>&lt;&lt; EOF | oc apply -f -
</span></span></span><span style=display:flex><span><span style=color:#e6db74>apiVersion: route.openshift.io/v1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>kind: Route
</span></span></span><span style=display:flex><span><span style=color:#e6db74>metadata:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  labels:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    app.kubernetes.io/name: microsweeper-appservice
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    app.kubernetes.io/version: 1.0.0-SNAPSHOT
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    app.openshift.io/runtime: quarkus
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  name: microsweeper-appservice
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  namespace: minesweeper
</span></span></span><span style=display:flex><span><span style=color:#e6db74>spec:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  host: minesweeper.aro.kmobb.com
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  to:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    kind: Service
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    name: microsweeper-appservice
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    weight: 100
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    targetPort:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>      port: 8080
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  wildcardPolicy: None
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div></li><li><p>Check the dns settings of your application.</p><blockquote><p>notice that the application URL is routed through Azure Front Door at the edge. The only way this application that is running on your cluster can be access is through Azure Front Door which is connected to your cluster through a private endpoint.</p></blockquote><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>nslookup $ARO_APP_FQDN
</span></span></code></pre></div><p>sample output:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-fallback data-lang=fallback><span style=display:flex><span>Server:		2600:1700:850:d220::1
</span></span><span style=display:flex><span>Address:	2600:1700:850:d220::1#53
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Non-authoritative answer:
</span></span><span style=display:flex><span>minesweeper.aro.kmobb.com	canonical name = aro-mine-13947-dxh0ahd7fzfyexgx.z01.azurefd.net.
</span></span><span style=display:flex><span>aro-mine-13947-dxh0ahd7fzfyexgx.z01.azurefd.net	canonical name = star-azurefd-prod.trafficmanager.net.
</span></span><span style=display:flex><span>star-azurefd-prod.trafficmanager.net	canonical name = dual.part-0013.t-0009.t-msedge.net.
</span></span><span style=display:flex><span>dual.part-0013.t-0009.t-msedge.net	canonical name = part-0013.t-0009.t-msedge.net.
</span></span><span style=display:flex><span>Name:	part-0013.t-0009.t-msedge.net
</span></span><span style=display:flex><span>Address: 13.107.213.41
</span></span><span style=display:flex><span>Name:	part-0013.t-0009.t-msedge.net
</span></span><span style=display:flex><span>Address: 13.107.246.41
</span></span></code></pre></div></li></ol><h2 id=test-the-application>Test the application</h2><p>Point your broswer to your domain!!
<img src=images/minesweeper.png></p><h2 id=clean-up>Clean up</h2><p>To clean up everything you created, simply delete the resource group</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>az group delete -g $ARORG
</span></span></code></pre></div><footer class=footline></footer></article></div></main></div><aside id=sidebar class=default-animation><div id=header-wrapper class=default-animation><div id=header class=default-animation><style>#logo svg,#logo svg *{color:#282828;color:var(--MENU-SECTIONS-BG-color);fill:#282828!important;fill:var(--MENU-SECTIONS-BG-color)!important;opacity:.945}a#logo{color:#282828;color:var(--MENU-SECTIONS-BG-color);font-family:work sans,helvetica,tahoma,geneva,arial,sans-serif;font-size:30px;font-weight:300;margin-top:-13px;max-width:80%;text-transform:uppercase;width:226px;white-space:nowrap}a#logo:hover{color:#282828;color:var(--MENU-SECTIONS-BG-color)}#logo svg{margin-bottom:-20px;margin-left:-23.5px;width:40.5%}@media only all and (max-width:59.938em){a#logo{font-size:25px;margin-top:-3px}#logo svg{margin-bottom:-12px;margin-left:-23px}}@media all and (-ms-high-contrast:none){a#logo{margin-top:-58px}#logo svg{margin-bottom:-62px}}</style><a id=logo href=https://rh-mobb.github.io/mobb_ninja/><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M341.52 285.56c33.65.0 82.34-6.94 82.34-47 .22-6.74.86-1.82-20.88-96.24-4.62-19.15-8.68-27.84-42.31-44.65-26.09-13.34-82.92-35.37-99.73-35.37-15.66.0-20.2 20.17-38.87 20.17-18 0-31.31-15.06-48.12-15.06-16.14.0-26.66 11-34.78 33.62-27.5 77.55-26.28 74.27-26.12 78.27.0 24.8 97.64 106.11 228.47 106.11M429 254.84c4.65 22 4.65 24.35 4.65 27.25.0 37.66-42.33 58.56-98 58.56-125.74.08-235.91-73.65-235.91-122.33a49.55 49.55.0 014.06-19.72C58.56 200.86.0 208.93.0 260.63c0 84.67 200.63 189 359.49 189 121.79.0 152.51-55.08 152.51-98.58.0-34.21-29.59-73.05-82.93-96.24"/></svg>MOBB Ninja</a></div><div class="searchbox default-animation"><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script>var contentLangs=["en"]</script><script src=https://rh-mobb.github.io/mobb_ninja/js/auto-complete.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.stemmer.support.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.multi.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/lunr.en.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/search.js?1673630122 defer></script></div><div id=homelinks class=default-animation><ul><li><a class=padding href=https://rh-mobb.github.io/mobb_ninja/><i class="fas fa-home"></i> Home</a></li></ul></div><div id=content-wrapper class=highlightable><ul class="topics collapsible-menu"><li data-nav-id=/docs/ title="Documentation from the MOBB" class="dd-item parent"><input type=checkbox id=section-2f67fdc9a362fd86f1cfd4450ed56551 class=toggle checked><label for=section-2f67fdc9a362fd86f1cfd4450ed56551></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/>Documentation from the MOBB</a><ul><li data-nav-id=/docs/quickstart-aro/ title="ARO Quickstart" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/quickstart-aro/>ARO Quickstart</a></li><li data-nav-id=/docs/quickstart-rosa/ title="ROSA Quickstart" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/quickstart-rosa/>ROSA Quickstart</a></li><li data-nav-id=/docs/aro/ title="Azure Red Hat OpenShift" class="dd-item parent"><input type=checkbox id=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a class=toggle checked><label for=section-ea9c20146e4edb7d3dc5cab0ddc4bd3a></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/>Azure Red Hat OpenShift</a><ul><li data-nav-id=/docs/aro/shipping-logs-and-metrics-to-azure-blob/ title="Azure Red Hat Openshift - Shippings logs and metrics to Azure Blob storage" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/shipping-logs-and-metrics-to-azure-blob/>Azure Red Hat Openshift - Shippings logs and metrics to Azure Blob storage</a></li><li data-nav-id=/docs/aro/registry/ title="Accessing the Internal Registry from ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/registry/>Accessing the Internal Registry from ARO</a></li><li data-nav-id=/docs/aro/additional-ingress-controller/ title="Adding an additional ingress controller to an ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/additional-ingress-controller/>Adding an additional ingress controller to an ARO cluster</a></li><li data-nav-id=/docs/aro/add-infra-nodes/ title="Adding infrastructure nodes to an ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/add-infra-nodes/>Adding infrastructure nodes to an ARO cluster</a></li><li data-nav-id=/docs/aro/azure-policy/ title="Apply Azure Policy to Azure Policy" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-policy/>Apply Azure Policy to Azure Policy</a></li><li data-nav-id=/docs/aro/disaster-recovery/ title="ARO - Considerations for Disaster Recovery" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/disaster-recovery/>ARO - Considerations for Disaster Recovery</a></li><li data-nav-id=/docs/aro/cert-manager/ title="ARO Custom domain with cert-manager and LetsEncrypt" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/cert-manager/>ARO Custom domain with cert-manager and LetsEncrypt</a></li><li data-nav-id=/docs/aro/ibm-cloud-paks-for-data/ title="ARO IBM Cloud Paks 4 Data" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/ibm-cloud-paks-for-data/>ARO IBM Cloud Paks 4 Data</a></li><li data-nav-id=/docs/aro/gpu/ title="ARO with Nvidia GPU Workloads" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/gpu/>ARO with Nvidia GPU Workloads</a></li><li data-nav-id=/docs/aro/frontdoor/ title="Azure Front Door with ARO ( Azure Red Hat OpenShift )" class="dd-item active"><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/frontdoor/>Azure Front Door with ARO ( Azure Red Hat OpenShift )</a></li><li data-nav-id=/docs/aro/azure-service-operator/ title="Azure Service Operator" class=dd-item><input type=checkbox id=section-c4973928d95ad0b6b86b8742709cea9d class=toggle><label for=section-c4973928d95ad0b6b86b8742709cea9d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/>Azure Service Operator</a><ul><li data-nav-id=/docs/aro/azure-service-operator/v1/ title="Azure Service Operator V1 in ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/v1/>Azure Service Operator V1 in ARO</a></li><li data-nav-id=/docs/aro/azure-service-operator/v2/ title="Azure Service Operator V2 in ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-service-operator/v2/>Azure Service Operator V2 in ARO</a></li></ul></li><li data-nav-id=/docs/aro/managed-upgrade-operator/ title="Enable the Managed Upgrade Operator in ARO and schedule Upgrades" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/managed-upgrade-operator/>Enable the Managed Upgrade Operator in ARO and schedule Upgrades</a></li><li data-nav-id=/docs/aro/federated-metrics/ title="Federating System and User metrics to Azure Files in Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/federated-metrics/>Federating System and User metrics to Azure Files in Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/aro/aro-machinesets/readme/ title="Helm Chart to set up extra MachineSets on ARO clusters" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/aro-machinesets/readme/>Helm Chart to set up extra MachineSets on ARO clusters</a></li><li data-nav-id=/docs/aro/astronomer/ title="Installing Astronomer on a private ARO cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/astronomer/>Installing Astronomer on a private ARO cluster</a></li><li data-nav-id=/docs/aro/azure-arc-integration/ title="Integrating Azure ARC with ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/azure-arc-integration/>Integrating Azure ARC with ARO</a></li><li data-nav-id=/docs/aro/odf/ title="OpenShift Data Foundation with ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/odf/>OpenShift Data Foundation with ARO</a></li><li data-nav-id=/docs/aro/private-cluster/ title="Private ARO Cluster with access via JumpHost" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/private-cluster/>Private ARO Cluster with access via JumpHost</a></li><li data-nav-id=/docs/aro/setup-quay/ title="Quay on ARO" class=dd-item><input type=checkbox id=section-107cd49f6d91378e87d08e36d5f67445 class=toggle><label for=section-107cd49f6d91378e87d08e36d5f67445></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/>Quay on ARO</a><ul><li data-nav-id=/docs/aro/setup-quay/quay-cli/ title="Setting up Quay on an ARO cluster via CLI" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/quay-cli/>Setting up Quay on an ARO cluster via CLI</a></li><li data-nav-id=/docs/aro/setup-quay/quay-console/ title="Setting up Quay on an ARO cluster via Console" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/setup-quay/quay-console/>Setting up Quay on an ARO cluster via Console</a></li></ul></li><li data-nav-id=/docs/aro/ocm/ title="Registering an ARO cluster to OpenShift Cluster Manager" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/ocm/>Registering an ARO cluster to OpenShift Cluster Manager</a></li><li data-nav-id=/docs/aro/vpn/ title="Setup a VPN Connection into an ARO Cluster with OpenVPN" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/vpn/>Setup a VPN Connection into an ARO Cluster with OpenVPN</a></li><li data-nav-id=/docs/aro/trident/ title="Trident NetApp operator setup for Azure NetApp files" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/trident/>Trident NetApp operator setup for Azure NetApp files</a></li><li data-nav-id=/docs/aro/clf-to-azure/ title="Using Cluster Logging Forwarder in ARO with Azure Monitor" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/clf-to-azure/>Using Cluster Logging Forwarder in ARO with Azure Monitor</a></li><li data-nav-id=/docs/aro/egress-ipam-operator/ title="Using the Egressip Ipam Operator with a Private ARO Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/aro/egress-ipam-operator/>Using the Egressip Ipam Operator with a Private ARO Cluster</a></li></ul></li><li data-nav-id=/docs/rosa/ title="Red Hat Openshift Service on AWS" class=dd-item><input type=checkbox id=section-d82bea3b793597b6ff01917e2ad59aae class=toggle><label for=section-d82bea3b793597b6ff01917e2ad59aae></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/>Red Hat Openshift Service on AWS</a><ul><li data-nav-id=/docs/rosa/aws-load-balancer-operator/ title="AWS Load Balancer Operator On ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-load-balancer-operator/>AWS Load Balancer Operator On ROSA</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-vector/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/clf-cloudwatch-vector/>Configuring the Cluster Log Forwarder for CloudWatch Logs using Vector</a></li><li data-nav-id=/docs/rosa/dynamic-certificates/ title="Dynamic Certificates for ROSA Custom Domain" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/dynamic-certificates/>Dynamic Certificates for ROSA Custom Domain</a></li><li data-nav-id=/docs/rosa/static-ip-load-balancer/ title="Configure a load balancer service to use a static public IP" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/static-ip-load-balancer/>Configure a load balancer service to use a static public IP</a></li><li data-nav-id=/docs/rosa/verify-permissions/ title="Verify Permissions for ROSA STS Deployment" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/verify-permissions/>Verify Permissions for ROSA STS Deployment</a></li><li data-nav-id=/docs/rosa/sts-oidc-flow/ title="STS OIDC in ROSA : How it works!" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-oidc-flow/>STS OIDC in ROSA : How it works!</a></li><li data-nav-id=/docs/rosa/security-ra/ title="Security Reference Architecture for ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/security-ra/>Security Reference Architecture for ROSA</a></li><li data-nav-id=/docs/rosa/rosa-asea-landing-zone/ title="Integrating ROSA and ASEA Landing Zones" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/rosa-asea-landing-zone/>Integrating ROSA and ASEA Landing Zones</a></li><li data-nav-id=/docs/rosa/ecr/ title="Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr/>Configuring a ROSA cluster to pull images from AWS Elastic Container Registry (ECR)</a></li><li data-nav-id=/docs/rosa/byo-vpc/ title="Creating a Public/Private BYO VPC for ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/byo-vpc/>Creating a Public/Private BYO VPC for ROSA</a></li><li data-nav-id=/docs/rosa/kms/ title="Creating a ROSA cluster in STS mode with custom KMS key" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/kms/>Creating a ROSA cluster in STS mode with custom KMS key</a></li><li data-nav-id=/docs/rosa/custom-alertmanager/ title="Custom Alerts in ROSA 4.11.x" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/custom-alertmanager/>Custom Alerts in ROSA 4.11.x</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/ title="ECR Secret Operator" class=dd-item><input type=checkbox id=section-d622abc3689c39008edcc95bca0300b1 class=toggle><label for=section-d622abc3689c39008edcc95bca0300b1></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/>ECR Secret Operator</a><ul><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_user/ title="Create IAM user and Policy" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/iam_user/>Create IAM user and Policy</a></li><li data-nav-id=/docs/rosa/ecr-secret-operator/iam_assume_role/ title="Create STS Assume Role" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ecr-secret-operator/iam_assume_role/>Create STS Assume Role</a></li></ul></li><li data-nav-id=/docs/rosa/aws-efs-csi-operator-sts/ title="Enabling the AWS EFS CSI Driver Operator on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-efs-csi-operator-sts/>Enabling the AWS EFS CSI Driver Operator on ROSA</a></li><li data-nav-id=/docs/rosa/waf/ title="Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS" class=dd-item><input type=checkbox id=section-6293c009b4929ddbd0c9b2918068ea94 class=toggle><label for=section-6293c009b4929ddbd0c9b2918068ea94></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/>Examples of using a WAF in front of ROSA / OSD on AWS / OCP on AWS</a><ul><li data-nav-id=/docs/rosa/waf/alb/ title="This is a POC of ROSA with a AWS WAF service" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/alb/>This is a POC of ROSA with a AWS WAF service</a></li><li data-nav-id=/docs/rosa/waf/readme-complex/ title="This is a POC of ROSA with a AWS WAF service" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/readme-complex/>This is a POC of ROSA with a AWS WAF service</a></li><li data-nav-id=/docs/rosa/waf/cloud-front/ title="Using CloudFront + WAF" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/waf/cloud-front/>Using CloudFront + WAF</a></li></ul></li><li data-nav-id=/docs/rosa/using-sts-with-aws-services/ title="Extending ROSA STS to include authentication with AWS Services" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/using-sts-with-aws-services/>Extending ROSA STS to include authentication with AWS Services</a></li><li data-nav-id=/docs/rosa/federated-metrics-prometheus/ title="Federating Metrics to a centralized Prometheus Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics-prometheus/>Federating Metrics to a centralized Prometheus Cluster</a></li><li data-nav-id=/docs/rosa/sts-and-pod-identity/ title="Integrating with AWS resources using Pod Identity" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-and-pod-identity/>Integrating with AWS resources using Pod Identity</a></li><li data-nav-id=/docs/rosa/cluster-metrics-to-aws-prometheus/ title="ROSA - Federating Metrics to AWS Prometheus" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/cluster-metrics-to-aws-prometheus/>ROSA - Federating Metrics to AWS Prometheus</a></li><li data-nav-id=/docs/rosa/aws-secrets-manager-csi/ title="Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-secrets-manager-csi/>Using AWS Secrets Manager CSI on Red Hat OpenShift on AWS with STS</a></li><li data-nav-id=/docs/rosa/metrics-to-cloudwatch-agent/ title="Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/metrics-to-cloudwatch-agent/>Using the AWS Cloud Watch agent to publish metrics to CloudWatch in ROSA</a></li><li data-nav-id=/docs/rosa/sts-cluster-logging-addon/ title="Work Around to fix the issue with the logging-addon on ROSA STS Clusters" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-cluster-logging-addon/>Work Around to fix the issue with the logging-addon on ROSA STS Clusters</a></li><li data-nav-id=/docs/rosa/clf-cloudwatch-sts/ title="Configuring the Cluster Log Forwarder for CloudWatch Logs and STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/clf-cloudwatch-sts/>Configuring the Cluster Log Forwarder for CloudWatch Logs and STS</a></li><li data-nav-id=/docs/rosa/sts/ title="Creating a ROSA cluster in STS mode" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts/>Creating a ROSA cluster in STS mode</a></li><li data-nav-id=/docs/rosa/private-link/ title="Creating a ROSA cluster with Private Link enabled" class=dd-item><input type=checkbox id=section-71f53e8bae0a034c83f5c2f0c7c9c315 class=toggle><label for=section-71f53e8bae0a034c83f5c2f0c7c9c315></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/private-link/>Creating a ROSA cluster with Private Link enabled</a><ul><li data-nav-id=/docs/rosa/private-link/public-ingress/ title="Adding a Public Ingress endpoint to a ROSA Private-Link Cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/private-link/public-ingress/>Adding a Public Ingress endpoint to a ROSA Private-Link Cluster</a></li></ul></li><li data-nav-id=/docs/rosa/sts-with-private-link/ title="Creating a ROSA cluster with Private Link enabled (custom VPC) and STS" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/sts-with-private-link/>Creating a ROSA cluster with Private Link enabled (custom VPC) and STS</a></li><li data-nav-id=/docs/rosa/custom-alertmanager-4.9/ title="Custom AlertManager in ROSA 4.9.x" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/custom-alertmanager-4.9/>Custom AlertManager in ROSA 4.9.x</a></li><li data-nav-id=/docs/rosa/aws-efs-operator-on-rosa/ title="Enabling the AWS EFS Operator on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/aws-efs-operator-on-rosa/>Enabling the AWS EFS Operator on ROSA</a></li><li data-nav-id=/docs/rosa/federated-metrics/ title="Federating System and User metrics to S3 in Red Hat OpenShift for AWS" class=dd-item><input type=checkbox id=section-9567eab834a47ae397393da72ca0280d class=toggle><label for=section-9567eab834a47ae397393da72ca0280d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics/>Federating System and User metrics to S3 in Red Hat OpenShift for AWS</a><ul><li data-nav-id=/docs/rosa/federated-metrics/user-defined/ title="User Workload Monitoring on Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/federated-metrics/user-defined/>User Workload Monitoring on Azure Red Hat OpenShift</a></li></ul></li><li data-nav-id=/docs/rosa/ack/ title="Using AWS Controllers for Kubernetes (ACK) on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/rosa/ack/>Using AWS Controllers for Kubernetes (ACK) on ROSA</a></li></ul></li><li data-nav-id=/docs/idp/ title="Configuring IDP for ROSA and OSD" class=dd-item><input type=checkbox id=section-de867ba7872b33ba38d343e5be5e3e1c class=toggle><label for=section-de867ba7872b33ba38d343e5be5e3e1c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/>Configuring IDP for ROSA and OSD</a><ul><li data-nav-id=/docs/idp/okta-grp-sync/ title="Using Group Sync Operator with Okta and ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/okta-grp-sync/>Using Group Sync Operator with Okta and ROSA/OSD</a></li><li data-nav-id=/docs/idp/azuread-aro/ title="Configure ARO to use Azure AD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread-aro/>Configure ARO to use Azure AD</a></li><li data-nav-id=/docs/idp/azuread-aro-cli/ title="Configure Azure AD as an OIDC identity provider for ARO with cli" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread-aro-cli/>Configure Azure AD as an OIDC identity provider for ARO with cli</a></li><li data-nav-id=/docs/idp/azuread/ title="Configure Azure AD as an OIDC identity provider for ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/azuread/>Configure Azure AD as an OIDC identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/gitlab-aro/ title="Configure GitLab as an identity provider for ARO" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/gitlab-aro/>Configure GitLab as an identity provider for ARO</a></li><li data-nav-id=/docs/idp/gitlab/ title="Configure GitLab as an identity provider for ROSA/OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/gitlab/>Configure GitLab as an identity provider for ROSA/OSD</a></li><li data-nav-id=/docs/idp/az-ad-grp-sync/ title="Using Group Sync Operator with Azure Active Directory and ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/az-ad-grp-sync/>Using Group Sync Operator with Azure Active Directory and ROSA</a></li><li data-nav-id=/docs/idp/group-claims/ title="MOBB Docs and Guides - group-claims" class=dd-item><input type=checkbox id=section-af199904c6a78739e6598ab72890c976 class=toggle><label for=section-af199904c6a78739e6598ab72890c976></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/>MOBB Docs and Guides - group-claims</a><ul><li data-nav-id=/docs/idp/group-claims/rosa/ title="Configure ROSA to use Azure AD Group Claims" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/rosa/>Configure ROSA to use Azure AD Group Claims</a></li><li data-nav-id=/docs/idp/group-claims/aro/ title="Configure ARO to use Azure AD Group Claims" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/idp/group-claims/aro/>Configure ARO to use Azure AD Group Claims</a></li></ul></li></ul></li><li data-nav-id=/docs/misc/ title=Miscellaneous class=dd-item><input type=checkbox id=section-4743293995ef089d075c101a4e477e5c class=toggle><label for=section-4743293995ef089d075c101a4e477e5c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/>Miscellaneous</a><ul><li data-nav-id=/docs/misc/tls-cipher-customization/ title="Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/tls-cipher-customization/>Configure ROSA/OSD to use custom TLS ciphers on the ingress controllers</a></li><li data-nav-id=/docs/misc/jup/ title="Jupyter Notebooks" class=dd-item><input type=checkbox id=section-7af6414e26181825f2ee42d2fad956be class=toggle><label for=section-7af6414e26181825f2ee42d2fad956be></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/>Jupyter Notebooks</a><ul><li data-nav-id=/docs/misc/jup/buildnotebook/ title="How to deploy Jupyter Notebook" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/buildnotebook/>How to deploy Jupyter Notebook</a></li><li data-nav-id=/docs/misc/jup/opendatahub-gpu/ title="Installing the Open Data Hub Operator" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/jup/opendatahub-gpu/>Installing the Open Data Hub Operator</a></li></ul></li><li data-nav-id=/docs/misc/default-router-custom-domain/ title="Stop default router from serving custom domain routes" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/default-router-custom-domain/>Stop default router from serving custom domain routes</a></li><li data-nav-id=/docs/misc/references/ title="Common Managed OpenShift References / Tasks" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/references/>Common Managed OpenShift References / Tasks</a></li><li data-nav-id=/docs/misc/secrets-store-csi/ title="Installing the Kubernetes Secret Store CSI on OpenShift" class=dd-item><input type=checkbox id=section-83dcfc1bac9347003164dd6ca6bb9da6 class=toggle><label for=section-83dcfc1bac9347003164dd6ca6bb9da6></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/>Installing the Kubernetes Secret Store CSI on OpenShift</a><ul><li data-nav-id=/docs/misc/secrets-store-csi/azure-key-vault/ title="Azure Key Vault CSI on Azure Red Hat OpenShift" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/azure-key-vault/>Azure Key Vault CSI on Azure Red Hat OpenShift</a></li><li data-nav-id=/docs/misc/secrets-store-csi/hashicorp-vault/ title="Installing the HashiCorp Vault Secret CSI Driver" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/secrets-store-csi/hashicorp-vault/>Installing the HashiCorp Vault Secret CSI Driver</a></li></ul></li><li data-nav-id=/docs/misc/common-images-namespace/ title="OpenShift - Sharing Common images" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/common-images-namespace/>OpenShift - Sharing Common images</a></li><li data-nav-id=/docs/misc/cost-management/ title="Red Hat Cost Management for Cloud Services" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/cost-management/>Red Hat Cost Management for Cloud Services</a></li><li data-nav-id=/docs/misc/oadp/ title="MOBB Docs and Guides - oadp" class=dd-item><input type=checkbox id=section-325dd7bf30613094ac338d7da82aacea class=toggle><label for=section-325dd7bf30613094ac338d7da82aacea></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/oadp/>MOBB Docs and Guides - oadp</a><ul><li data-nav-id=/docs/misc/oadp/rosa-sts/ title="Deploying OpenShift Advanced Data Protection on a ROSA cluster" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/misc/oadp/rosa-sts/>Deploying OpenShift Advanced Data Protection on a ROSA cluster</a></li></ul></li></ul></li><li data-nav-id=/docs/o11y/ title=Observability class=dd-item><input type=checkbox id=section-cf64d50e30bf8c808e1a384a9dd9f94e class=toggle><label for=section-cf64d50e30bf8c808e1a384a9dd9f94e></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/>Observability</a><ul><li data-nav-id=/docs/o11y/openshift-logging/ title="OpenShift Logging" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/openshift-logging/>OpenShift Logging</a></li><li data-nav-id=/docs/o11y/az-log-analytics/ title="Shipping logs to Azure Log Analytics" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/o11y/az-log-analytics/>Shipping logs to Azure Log Analytics</a></li></ul></li><li data-nav-id=/docs/gcp/ title="OSD on Google Cloud" class=dd-item><input type=checkbox id=section-34c34dd71fe103bc20cfa9eed6fa905c class=toggle><label for=section-34c34dd71fe103bc20cfa9eed6fa905c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/>OSD on Google Cloud</a><ul><li data-nav-id=/docs/gcp/filestore/ title="Create Filestore Storage for OSD in GCP" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/filestore/>Create Filestore Storage for OSD in GCP</a></li><li data-nav-id=/docs/gcp/osd_preexisting_vpc/ title="Creating a OSD in GCP with Existing VPCs" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/gcp/osd_preexisting_vpc/>Creating a OSD in GCP with Existing VPCs</a></li></ul></li><li data-nav-id=/docs/redhat/ title="Other Red Hat Products" class=dd-item><input type=checkbox id=section-61ee77d4a0d9667d2a6b99ce46059f1d class=toggle><label for=section-61ee77d4a0d9667d2a6b99ce46059f1d></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/>Other Red Hat Products</a><ul><li data-nav-id=/docs/redhat/gitops/ title="Demonstrate GitOps on Managed OpenShift with ArgoCD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/gitops/>Demonstrate GitOps on Managed OpenShift with ArgoCD</a></li><li data-nav-id=/docs/redhat/3scale/ title="Deploying 3scale API Management to ROSA and OSD" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/3scale/>Deploying 3scale API Management to ROSA and OSD</a></li><li data-nav-id=/docs/redhat/rhacs/ title="Deploying Red Hat Advanced Cluster Security in ARO/ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/rhacs/>Deploying Red Hat Advanced Cluster Security in ARO/ROSA</a></li><li data-nav-id=/docs/redhat/crane/ title="Migrate Kubernetes Applications with Konveyer Crane" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/crane/>Migrate Kubernetes Applications with Konveyer Crane</a></li><li data-nav-id=/docs/redhat/acm/ title="Advanced Cluster Management" class=dd-item><input type=checkbox id=section-d7942abe72cdf38022f3b7c824316905 class=toggle><label for=section-d7942abe72cdf38022f3b7c824316905></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/>Advanced Cluster Management</a><ul><li data-nav-id=/docs/redhat/acm/observability/ title="Advanced Cluster Management - Observability" class=dd-item><input type=checkbox id=section-16c8cbcc1de529ce480045089e9bde5c class=toggle><label for=section-16c8cbcc1de529ce480045089e9bde5c></label><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/observability/>Advanced Cluster Management - Observability</a><ul><li data-nav-id=/docs/redhat/acm/observability/rosa/ title="Advanced Cluster Management Observability on ROSA" class=dd-item><a href=https://rh-mobb.github.io/mobb_ninja/docs/redhat/acm/observability/rosa/>Advanced Cluster Management Observability on ROSA</a></li></ul></li></ul></li></ul></li></ul></li></ul><div id=shortcuts><div class=nav-title></div><ul><li><a class=padding href=https://github.com/rh-mobb/documentation target=_blank><i class='fab fa-fw fa-github'></i> Github</a></li><li><a class=padding href=https://github.com/rh-mobb/documentation/archive/refs/heads/main.zip target=_blank><i class='fas fa-fw fa-file-download'></i> Download</a></li><li><a class=padding href=https://www.redhat.com/en/blog target=_blank><i class='fab fa-fw fa-redhat'></i> Red Hat Blog</a></li><li><a class=padding href=https://rh-mobb.github.io/mobb_ninja/tags/ target=_blank><i class='fas fa-fw fa-tags'></i> Tags</a></li></ul></div><div class="footermargin footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"></div><hr class="default-animation footerLangSwitch footerVariantSwitch footerVisitedLinks footerFooter showFooter"><div id=prefooter class="footerLangSwitch footerVariantSwitch footerVisitedLinks"><ul><li id=select-language-container class=footerLangSwitch><a class="padding select-container"><i class="fas fa-language fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-language onchange="location=baseUri+this.value"></select></div><div class=select-clear></div></a></li><li id=select-variant-container class=footerVariantSwitch><a class="padding select-container"><i class="fas fa-paint-brush fa-fw"></i>
<span>&nbsp;</span><div class=select-style><select id=select-variant onchange=window.variants&&variants.changeVariant(this.value)><option id=red value=red selected>Red</option></select></div><div class=select-clear></div></a><script>window.variants&&variants.markSelectedVariant()</script></li><li class=footerVisitedLinks><a class=padding onclick=clearHistory()><i class="fas fa-history fa-fw"></i> Clear History</a></li></ul></div><div id=footer class="footerFooter showFooter"><p>Built with <a href=https://github.com/McShelby/hugo-theme-relearn><i class="fas fa-heart"></i></a> by <a href=https://gohugo.io/>Hugo</a></p></div></div></aside><script src=https://rh-mobb.github.io/mobb_ninja/js/clipboard.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/perfect-scrollbar.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/featherlight.min.js?1673630122 defer></script>
<script src=https://rh-mobb.github.io/mobb_ninja/js/theme.js?1673630122 defer></script></body></html>